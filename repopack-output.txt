This file is a merged representation of the entire codebase, combining all repository files into a single document.
Generated by Repopack on: 2024-10-04T13:05:11.579Z

================================================================
File Summary
================================================================

Purpose:
--------
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.

File Format:
------------
The content is organized as follows:
1. This summary section
2. Repository information
3. Repository structure
4. Multiple file entries, each consisting of:
  a. A separator line (================)
  b. The file path (File: path/to/file)
  c. Another separator line
  d. The full contents of the file
  e. A blank line

Usage Guidelines:
-----------------
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.

Notes:
------
- Some files may have been excluded based on .gitignore rules and Repopack's
  configuration.
- Binary files are not included in this packed representation. Please refer to
  the Repository Structure section for a complete list of file paths, including
  binary files.

Additional Info:
----------------

For more information about Repopack, visit: https://github.com/yamadashy/repopack

================================================================
Repository Structure
================================================================
.dockerignore
.gitattributes
.github/dependabot.yml
.github/workflows/ci.yml
.rubocop.yml
.ruby-version
app/assets/config/manifest.js
app/assets/stylesheets/application.css
app/assets/stylesheets/application.tailwind.css
app/channels/application_cable/channel.rb
app/channels/application_cable/connection.rb
app/controllers/application_controller.rb
app/controllers/pages_controller.rb
app/controllers/prds_controller.rb
app/controllers/product_ideas_controller.rb
app/controllers/product_manager_copilot_controller.rb
app/helpers/application_helper.rb
app/helpers/pages_helper.rb
app/helpers/prds_helper.rb
app/helpers/product_ideas_helper.rb
app/javascript/application.js
app/javascript/controllers/application.js
app/javascript/controllers/dropdown_controller.js
app/javascript/controllers/hello_controller.js
app/javascript/controllers/index.js
app/jobs/application_job.rb
app/jobs/generate_prd_job.rb
app/mailers/application_mailer.rb
app/models/application_record.rb
app/models/conversation.rb
app/models/message.rb
app/models/prd.rb
app/models/product_idea.rb
app/models/user.rb
app/views/devise/confirmations/new.html.erb
app/views/devise/mailer/confirmation_instructions.html.erb
app/views/devise/mailer/email_changed.html.erb
app/views/devise/mailer/password_change.html.erb
app/views/devise/mailer/reset_password_instructions.html.erb
app/views/devise/mailer/unlock_instructions.html.erb
app/views/devise/passwords/edit.html.erb
app/views/devise/passwords/new.html.erb
app/views/devise/registrations/edit.html.erb
app/views/devise/registrations/new.html.erb
app/views/devise/sessions/new.html.erb
app/views/devise/shared/_error_messages.html.erb
app/views/devise/shared/_links.html.erb
app/views/devise/unlocks/new.html.erb
app/views/layouts/_navbar.html.erb
app/views/layouts/application.html.erb
app/views/layouts/mailer.html.erb
app/views/layouts/mailer.text.erb
app/views/pages/dashboard.html.erb
app/views/pages/home.html.erb
app/views/prds/create.html.erb
app/views/prds/edit.html.erb
app/views/prds/generating.html.erb
app/views/prds/new.html.erb
app/views/prds/show.html.erb
app/views/product_ideas/_form.html.erb
app/views/product_ideas/create.html.erb
app/views/product_ideas/destroy.html.erb
app/views/product_ideas/edit.html.erb
app/views/product_ideas/index.html.erb
app/views/product_ideas/new.html.erb
app/views/product_ideas/show.html.erb
app/views/product_ideas/update.html.erb
app/views/product_manager_copilot/show.html.erb
app/views/pwa/manifest.json.erb
app/views/pwa/service-worker.js
app/views/shared/_navbar.html.erb
app/views/shared/_notification.html.erb
bin/brakeman
bin/bundle
bin/bundle.cmd
bin/dev
bin/docker-entrypoint
bin/importmap
bin/rails
bin/rake
bin/rubocop
bin/setup
config.ru
config/application.rb
config/boot.rb
config/cable.yml
config/credentials.yml.enc
config/database.yml
config/environment.rb
config/environments/development.rb
config/environments/production.rb
config/environments/test.rb
config/importmap.rb
config/initializers/assets.rb
config/initializers/content_security_policy.rb
config/initializers/devise.rb
config/initializers/filter_parameter_logging.rb
config/initializers/inflections.rb
config/initializers/openai.rb
config/initializers/permissions_policy.rb
config/initializers/sidekiq.rb
config/locales/devise.en.yml
config/locales/en.yml
config/puma.rb
config/routes.rb
config/sidekiq.yml
config/storage.yml
config/tailwind.config.js
db/migrate/20240914144559_create_product_ideas.rb
db/migrate/20240914200110_devise_create_users.rb
db/migrate/20240915190419_add_user_to_product_ideas.rb
db/migrate/20240915232910_create_prds.rb
db/migrate/20240916203842_add_status_to_prds.rb
db/migrate/20240917200038_add_prd_context_to_product_ideas.rb
db/migrate/20241002232128_create_conversations.rb
db/migrate/20241002232134_create_messages.rb
db/migrate/20241002232541_update_prds_to_uuid.rb
db/migrate/20241002233619_update_prds_id_to_uuid.rb
db/migrate/20241002233844_convert_prds_to_uuid.rb
db/schema.rb
db/seeds.rb
Dockerfile
Gemfile
Gemfile.lock
package.json
Procfile.dev
public/404.html
public/406-unsupported-browser.html
public/422.html
public/500.html
public/icon.svg
public/robots.txt
Rakefile
README.md
test/application_system_test_case.rb
test/channels/application_cable/connection_test.rb
test/controllers/pages_controller_test.rb
test/controllers/prds_controller_test.rb
test/controllers/product_ideas_controller_test.rb
test/fixtures/prds.yml
test/fixtures/product_ideas.yml
test/fixtures/users.yml
test/models/prd_test.rb
test/models/product_idea_test.rb
test/models/user_test.rb
test/test_helper.rb

================================================================
Repository Files
================================================================

================
File: .dockerignore
================
# See https://docs.docker.com/engine/reference/builder/#dockerignore-file for more about ignoring files.

# Ignore git directory.
/.git/
/.gitignore

# Ignore bundler config.
/.bundle

# Ignore all environment files (except templates).
/.env*
!/.env*.erb

# Ignore all default key files.
/config/master.key
/config/credentials/*.key

# Ignore all logfiles and tempfiles.
/log/*
/tmp/*
!/log/.keep
!/tmp/.keep

# Ignore pidfiles, but keep the directory.
/tmp/pids/*
!/tmp/pids/.keep

# Ignore storage (uploaded files in development and any SQLite databases).
/storage/*
!/storage/.keep
/tmp/storage/*
!/tmp/storage/.keep

# Ignore assets.
/node_modules/
/app/assets/builds/*
!/app/assets/builds/.keep
/public/assets

# Ignore CI service files.
/.github

# Ignore development files
/.devcontainer

# Ignore Docker-related files
/.dockerignore
/Dockerfile*

================
File: .gitattributes
================
# See https://git-scm.com/docs/gitattributes for more about git attribute files.

# Mark the database schema as having been generated.
db/schema.rb linguist-generated

# Mark any vendored files as having been vendored.
vendor/* linguist-vendored
config/credentials/*.yml.enc diff=rails_credentials
config/credentials.yml.enc diff=rails_credentials

================
File: .github/dependabot.yml
================
version: 2
updates:
- package-ecosystem: bundler
  directory: "/"
  schedule:
    interval: daily
  open-pull-requests-limit: 10
- package-ecosystem: github-actions
  directory: "/"
  schedule:
    interval: daily
  open-pull-requests-limit: 10

================
File: .github/workflows/ci.yml
================
name: CI

on:
  pull_request:
  push:
    branches: [ main ]

jobs:
  scan_ruby:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Ruby
        uses: ruby/setup-ruby@v1
        with:
          ruby-version: .ruby-version
          bundler-cache: true

      - name: Scan for common Rails security vulnerabilities using static analysis
        run: bin/brakeman --no-pager

  scan_js:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Ruby
        uses: ruby/setup-ruby@v1
        with:
          ruby-version: .ruby-version
          bundler-cache: true

      - name: Scan for security vulnerabilities in JavaScript dependencies
        run: bin/importmap audit

  lint:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Ruby
        uses: ruby/setup-ruby@v1
        with:
          ruby-version: .ruby-version
          bundler-cache: true

      - name: Lint code for consistent style
        run: bin/rubocop -f github

  test:
    runs-on: ubuntu-latest

    services:
      postgres:
        image: postgres
        env:
          POSTGRES_USER: postgres
          POSTGRES_PASSWORD: postgres
        ports:
          - 5432:5432
        options: --health-cmd="pg_isready" --health-interval=10s --health-timeout=5s --health-retries=3

      # redis:
      #   image: redis
      #   ports:
      #     - 6379:6379
      #   options: --health-cmd "redis-cli ping" --health-interval 10s --health-timeout 5s --health-retries 5

    steps:
      - name: Install packages
        run: sudo apt-get update && sudo apt-get install --no-install-recommends -y google-chrome-stable curl libjemalloc2 libvips postgresql-client

      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Ruby
        uses: ruby/setup-ruby@v1
        with:
          ruby-version: .ruby-version
          bundler-cache: true

      - name: Run tests
        env:
          RAILS_ENV: test
          DATABASE_URL: postgres://postgres:postgres@localhost:5432
          # REDIS_URL: redis://localhost:6379/0
        run: bin/rails db:test:prepare test test:system

      - name: Keep screenshots from failed system tests
        uses: actions/upload-artifact@v4
        if: failure()
        with:
          name: screenshots
          path: ${{ github.workspace }}/tmp/screenshots
          if-no-files-found: ignore

================
File: .rubocop.yml
================
# Omakase Ruby styling for Rails
inherit_gem: { rubocop-rails-omakase: rubocop.yml }

# Overwrite or add rules to create your own house style
#
# # Use `[a, [b, c]]` not `[ a, [ b, c ] ]`
# Layout/SpaceInsideArrayLiteralBrackets:
#   Enabled: false

================
File: .ruby-version
================
ruby-3.3.5

================
File: app/assets/config/manifest.js
================
//= link_tree ../images
//= link_directory ../stylesheets .css
//= link_tree ../../javascript .js
//= link_tree ../../../vendor/javascript .js
//= link_tree ../builds

================
File: app/assets/stylesheets/application.css
================
/*
 * This is a manifest file that'll be compiled into application.css, which will include all the files
 * listed below.
 *
 * Any CSS (and SCSS, if configured) file within this directory, lib/assets/stylesheets, or any plugin's
 * vendor/assets/stylesheets directory can be referenced here using a relative path.
 *
 * You're free to add application-wide styles to this file and they'll appear at the bottom of the
 * compiled file so the styles you add here take precedence over styles defined in any other CSS
 * files in this directory. Styles in this file should be added after the last require_* statement.
 * It is generally better to create a new file per style scope.
 *
 *= require_tree .
 *= require_self
 */

 @keyframes notification-bounce {
    0%, 100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-10px);
    }
  }
  
  .transform-bounce {
    animation: notification-bounce 0.5s ease-in-out;
  }
  
  .notification {
    z-index: 9999; /* Ensure it's above other elements */
  }

  .notification {
    transition: transform 0.5s ease-out, opacity 0.5s ease-out;
  }
  
  .notification.translate-y-0 {
    transform: translateY(0);
  }
  
  .notification.translate-y-full {
    transform: translateY(100%);
  }
  
  .notification.opacity-0 {
    opacity: 0;
  }
  
  .notification.opacity-100 {
    opacity: 1;
  }

  .notification {
    max-width: 300px;
    animation: fadeIn 0.5s, fadeOut 0.5s 4.5s;
    opacity: 0;
    animation-fill-mode: forwards;
  }
  
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  @keyframes fadeOut {
    from { opacity: 1; transform: translateY(0); }
    to { opacity: 0; transform: translateY(-20px); }
  }

================
File: app/assets/stylesheets/application.tailwind.css
================
@import "tailwindcss/base";
@import "tailwindcss/components";
@import "tailwindcss/utilities";

/* Add custom styles here */
.prose h1 {
  @apply text-2xl font-bold mt-6 mb-4;
}

.prose h2 {
  @apply text-xl font-semibold mt-5 mb-3;
}

.prose h3 {
  @apply text-lg font-medium mt-4 mb-2;
}

.prose p {
  @apply my-2;
}

.prose ul, .prose ol {
  @apply my-2 pl-5;
}

.prose li {
  @apply my-1;
}

@media (max-width: 640px) {
  .max-w-4xl {
    @apply px-4;
  }
  
  .prose {
    @apply text-sm;
  }
}

@media (min-width: 641px) and (max-width: 1024px) {
  .max-w-4xl {
    @apply px-6;
  }
}

================
File: app/channels/application_cable/channel.rb
================
module ApplicationCable
  class Channel < ActionCable::Channel::Base
  end
end

================
File: app/channels/application_cable/connection.rb
================
module ApplicationCable
  class Connection < ActionCable::Connection::Base
  end
end

================
File: app/controllers/application_controller.rb
================
class ApplicationController < ActionController::Base
  # Only allow modern browsers supporting webp images, web push, badges, import maps, CSS nesting, and CSS :has.
  allow_browser versions: :modern
end

def after_sign_in_path_for(resource)
  authenticated_root_path
end

class ApplicationController < ActionController::Base
  before_action :authenticate_user!
end

class ApplicationController < ActionController::Base
  def after_sign_out_path_for(resource_or_scope)
    root_path # or any other path you prefer
  end
end

class ApplicationController < ActionController::Base
  before_action :prepare_notifications

  private

  def prepare_notifications
    return if flash.empty?

    if turbo_frame_request?
      flash.each do |type, message|
        response.set_header('Turbo-Stream', turbo_stream.append("notifications", partial: "shared/notification", locals: { message: message, type: type }))
      end
    else
      @notifications = flash.map do |type, message|
        { type: type, message: message }
      end
    end
  end
end

================
File: app/controllers/pages_controller.rb
================
class PagesController < ApplicationController
  skip_before_action :authenticate_user!, only: [:home]

  def home
    redirect_to authenticated_root_path if user_signed_in?
  end

  def dashboard
    # Add any dashboard-specific logic here
  end
end

================
File: app/controllers/prds_controller.rb
================
class PrdsController < ApplicationController
  before_action :set_product_idea
  before_action :set_prd, only: [:show, :generating, :check_status]

  def new
    @prd = @product_idea.prds.new
  end

  def create
    @prd = @product_idea.prds.new(prd_params)
    @prd.status = 'pending'

    if @prd.save
      GeneratePrdJob.perform_later(@prd.id)
      flash[:notice] = 'PRD generation has started. Please wait...'
      redirect_to generating_product_idea_prd_path(@product_idea, @prd)
    else
      flash[:alert] = 'Failed to start PRD generation. Please try again.'
      render :new
    end
  end

  def show
    flash[:notice] = 'PRD generated successfully!' if @prd.status == 'completed'
  end

  def generating
  end

  def check_status
    render json: { 
      status: @prd.status, 
      url: @prd.status == 'completed' ? product_idea_prd_path(@product_idea, @prd) : nil,
      error: @prd.status == 'failed' ? @prd.content : nil
    }
  end

  private

  def set_product_idea
    @product_idea = ProductIdea.find(params[:product_idea_id])
  end

  def set_prd
    @prd = @product_idea.prds.includes(:product_idea).find(params[:id])
  end

  def prd_params
    params.require(:prd).permit(:title)
  end
end

================
File: app/controllers/product_ideas_controller.rb
================
class ProductIdeasController < ApplicationController
  before_action :authenticate_user!
  before_action :set_product_idea, only: [:show, :edit, :update, :destroy]

  def index
    @product_ideas = current_user.product_ideas.order(created_at: :desc)
  end

  def show
  end

  def new
    @product_idea = current_user.product_ideas.build
  end

  def edit
  end

  def create
    @product_idea = current_user.product_ideas.build(product_idea_params)

    respond_to do |format|
      if @product_idea.save
        format.html { redirect_to product_ideas_path, notice: 'Product idea was successfully created.' }
        format.json { render :show, status: :created, location: @product_idea }
      else
        format.html { render :new }
        format.json { render json: @product_idea.errors, status: :unprocessable_entity }
      end
    end
  end

  def update
    if @product_idea.update(product_idea_params)
      redirect_to @product_idea, notice: 'Product idea was successfully updated.'
    else
      render :edit
    end
  end

  def destroy
    @product_idea.destroy
    redirect_to product_ideas_url, notice: 'Product idea was successfully destroyed.'
  end

  private

  def set_product_idea
    @product_idea = current_user.product_ideas.find(params[:id])
  end

  def product_idea_params
    params.require(:product_idea).permit(:title, :description, :status, :customer_acv, :customer_impact, :tshirt_size_effort)
  end
end

================
File: app/controllers/product_manager_copilot_controller.rb
================
# app/controllers/product_manager_copilot_controller.rb
class ProductManagerCopilotController < ApplicationController
    before_action :authenticate_user!
    before_action :set_product_idea
    before_action :set_prd
    before_action :set_conversation, only: [:show, :update]
  
    def show
      @messages = @conversation.messages.order(created_at: :asc)
    end
  
    def create
      @conversation = @prd.conversations.create!
      redirect_to product_idea_prd_product_manager_copilot_path(@product_idea, @prd, @conversation)
    end
  
    def update
      message = @conversation.messages.create!(content: params[:message], role: 'user')
      
      ai_response = generate_ai_response(@conversation, message.content)
      
      @conversation.messages.create!(content: ai_response, role: 'assistant')
      
      updated_prd_content = update_prd_content(ai_response)
  
      render json: { 
        response: ai_response,
        updated_prd_content: updated_prd_content
      }
    end
  
    private
  
    def set_product_idea
      @product_idea = ProductIdea.find(params[:product_idea_id])
    end
  
    def set_prd
      @prd = @product_idea.prds.find(params[:prd_id])
    end
  
    def set_conversation
      @conversation = @prd.conversations.find(params[:id])
    end
  
    def generate_ai_response(conversation, user_message)
      messages = conversation.messages.order(created_at: :asc).map do |msg|
        { role: msg.role, content: msg.content }
      end
  
      client = OpenAI::Client.new
      response = client.chat(
        parameters: {
          model: "gpt-3.5-turbo",
          messages: [
            { role: "system", content: "You are a helpful Product Manager Copilot. Assist the user in improving their PRD." },
            *messages
          ],
          temperature: 0.7,
          max_tokens: 150
        }
      )
  
      case user_message
      when "Improve PRD structure"
        "Here are some suggestions to improve your PRD structure: [List of improvements]"
      when "Clarify requirements"
        "Let's clarify the requirements in your PRD. Which section would you like to focus on?"
      when "Suggest features"
        "Based on your current PRD, here are some feature suggestions: [List of features]"
      when "Review PRD"
        "I've reviewed your PRD. Here are my observations and suggestions: [Review points]"
      else
        response.dig("choices", 0, "message", "content") || "I'm here to help with your PRD. What specific aspect would you like assistance with?"
      end
    end
  
    def update_prd_content(ai_response)
      new_content = @prd.content + "\n\nCopilot Suggestion: " + ai_response
      @prd.update(content: new_content)
      new_content
    end
  end

================
File: app/helpers/application_helper.rb
================
module ApplicationHelper
    def status_color(status)
      case status
      when 'New'
        'bg-blue-100 text-blue-800'
      when 'In Progress'
        'bg-yellow-100 text-yellow-800'
      when 'Completed'
        'bg-green-100 text-green-800'
      else
        'bg-gray-100 text-gray-800'
      end
    end
  end

================
File: app/helpers/pages_helper.rb
================
module PagesHelper
end

================
File: app/helpers/prds_helper.rb
================
module PrdsHelper
end

================
File: app/helpers/product_ideas_helper.rb
================
module ProductIdeasHelper
end

================
File: app/javascript/application.js
================
import "@hotwired/turbo-rails"
import { Application } from "@hotwired/stimulus"
import { registerControllers } from "controllers"

const application = Application.start()
registerControllers(application)

// Configure Stimulus development experience
application.debug = false
window.Stimulus   = application

export { application }

================
File: app/javascript/controllers/application.js
================
import { Application } from "@hotwired/stimulus"

const application = Application.start()

// Configure Stimulus development experience
application.debug = false
window.Stimulus   = application

export { application }

================
File: app/javascript/controllers/dropdown_controller.js
================
import { Controller } from "@hotwired/stimulus"

export default class extends Controller {
  static targets = [ "menu" ]

  connect() {
    console.log("Dropdown controller connected")
  }

  toggle() {
    console.log("Toggle method called")
    this.menuTarget.classList.toggle('hidden')
  }

  hide(event) {
    if (!this.element.contains(event.target)) {
      this.menuTarget.classList.add('hidden')
    }
  }

  disconnect() {
    document.removeEventListener('click', this.hide.bind(this))
  }
}

================
File: app/javascript/controllers/hello_controller.js
================
import { Controller } from "@hotwired/stimulus"

export default class extends Controller {
  connect() {
    this.element.textContent = "Hello World!"
  }
}

================
File: app/javascript/controllers/index.js
================
import { application } from "./application"

// Import and register all your controllers from the importmap under controllers/*
import { eagerLoadControllersFrom } from "@hotwired/stimulus-loading"
eagerLoadControllersFrom("controllers", application)

// Lazy load controllers as they appear in the DOM (remember not to preload controllers in import map!)
// import { lazyLoadControllersFrom } from "@hotwired/stimulus-loading"
// lazyLoadControllersFrom("controllers", application)

================
File: app/jobs/application_job.rb
================
class ApplicationJob < ActiveJob::Base
  # Automatically retry jobs that encountered a deadlock
  # retry_on ActiveRecord::Deadlocked

  # Most jobs are safe to ignore if the underlying records are no longer available
  # discard_on ActiveJob::DeserializationError
end

================
File: app/jobs/generate_prd_job.rb
================
# app/jobs/generate_prd_job.rb
class GeneratePrdJob < ApplicationJob
    queue_as :default
  
    def perform(prd_id)
      prd = Prd.includes(:product_idea).find(prd_id)
      begin
        generated_content = generate_prd_content(prd.product_idea)
        prd.update!(content: generated_content, status: 'completed')
      rescue => e
        Rails.logger.error "PRD generation failed for PRD #{prd_id}: #{e.message}"
        Rails.logger.error e.backtrace.join("\n")
        prd.update!(status: 'failed', content: "Generation failed: #{e.message}")
      end
    end
  
    private
  
    def generate_prd_content(product_idea)
      client = OpenAI::Client.new
  
      prompt = <<~PROMPT
        Generate a Product Requirements Document (PRD) for the following product idea:
  
        Title: #{product_idea.title}
        Description: #{product_idea.description}
        Customer ACV: $#{product_idea.customer_acv}
        Customer Impact: #{product_idea.customer_impact}
        T-Shirt Size Effort: #{product_idea.tshirt_size_effort.upcase}
  
        The PRD should include the following sections:
        1. Executive Summary
        2. Problem Statement
        3. Product Overview
        4. Features and Functionality
        5. User Stories
        6. Technical Requirements
        7. Timeline and Milestones
        8. Risks and Mitigation Strategies
        9. Success Metrics
  
        Please provide detailed and specific information for each section based on the given product idea.
        Consider the Customer ACV, Customer Impact, and T-Shirt Size Effort when determining the scope and priority of features.
      PROMPT
  
      response = client.chat(
        parameters: {
          model: "gpt-3.5-turbo",
          messages: [{ role: "user", content: prompt }],
          temperature: 0.7,
          max_tokens: 2000
        }
      )
  
      response.dig("choices", 0, "message", "content")
    end
  end

================
File: app/mailers/application_mailer.rb
================
class ApplicationMailer < ActionMailer::Base
  default from: "from@example.com"
  layout "mailer"
end

================
File: app/models/application_record.rb
================
class ApplicationRecord < ActiveRecord::Base
  primary_abstract_class
end

================
File: app/models/conversation.rb
================
# app/models/conversation.rb
class Conversation < ApplicationRecord
    belongs_to :prd
    has_many :messages, dependent: :destroy
  
    validates :prd, presence: true
  
    # Add this line to use UUID
    self.implicit_order_column = "created_at"
  end

================
File: app/models/message.rb
================
# app/models/message.rb
class Message < ApplicationRecord
    belongs_to :conversation
  
    validates :content, presence: true
    validates :role, presence: true, inclusion: { in: %w[user assistant] }
  
    # Add this line to use UUID
    self.implicit_order_column = "created_at"
  end

================
File: app/models/prd.rb
================
class Prd < ApplicationRecord
  belongs_to :product_idea
  has_many :conversations, dependent: :destroy

  validates :status, presence: true
  validates :title, presence: true

  # If you want to keep strict loading for other associations but allow lazy loading for product_idea
  self.strict_loading_by_default = true
  belongs_to :product_idea, strict_loading: false

  # Add this line to use UUID
  self.implicit_order_column = "created_at"

  # Add this line to set a default status if none is provided
  after_initialize :set_default_status, if: :new_record?

  private

  def set_default_status
    self.status ||= 'pending'
  end
end

================
File: app/models/product_idea.rb
================
class ProductIdea < ApplicationRecord
    belongs_to :user
    has_many :prds, dependent: :destroy
  
    validates :title, presence: true
    validates :description, presence: true
    validates :status, presence: true
    validates :customer_acv, numericality: { greater_than_or_equal_to: 0, allow_nil: true }
    validates :customer_impact, presence: true, allow_blank: true
    validates :tshirt_size_effort, presence: true, allow_blank: true
  
    # If you want to keep strict loading for other associations but allow lazy loading for prds
    #self.strict_loading_by_default = true
    has_many :prds, dependent: :destroy, strict_loading: false
  end

================
File: app/models/user.rb
================
class User < ApplicationRecord
  # Include default devise modules. Others available are:
  # :confirmable, :lockable, :timeoutable, :trackable and :omniauthable
  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :validatable
  
  has_many :product_ideas, strict_loading: false
end

================
File: app/views/devise/confirmations/new.html.erb
================
<h2>Resend confirmation instructions</h2>

<%= form_for(resource, as: resource_name, url: confirmation_path(resource_name), html: { method: :post }) do |f| %>
  <%= render "devise/shared/error_messages", resource: resource %>

  <div class="field">
    <%= f.label :email %><br />
    <%= f.email_field :email, autofocus: true, autocomplete: "email", value: (resource.pending_reconfirmation? ? resource.unconfirmed_email : resource.email) %>
  </div>

  <div class="actions">
    <%= f.submit "Resend confirmation instructions" %>
  </div>
<% end %>

<%= render "devise/shared/links" %>

================
File: app/views/devise/mailer/confirmation_instructions.html.erb
================
<p>Welcome <%= @email %>!</p>

<p>You can confirm your account email through the link below:</p>

<p><%= link_to 'Confirm my account', confirmation_url(@resource, confirmation_token: @token) %></p>

================
File: app/views/devise/mailer/email_changed.html.erb
================
<p>Hello <%= @email %>!</p>

<% if @resource.try(:unconfirmed_email?) %>
  <p>We're contacting you to notify you that your email is being changed to <%= @resource.unconfirmed_email %>.</p>
<% else %>
  <p>We're contacting you to notify you that your email has been changed to <%= @resource.email %>.</p>
<% end %>

================
File: app/views/devise/mailer/password_change.html.erb
================
<p>Hello <%= @resource.email %>!</p>

<p>We're contacting you to notify you that your password has been changed.</p>

================
File: app/views/devise/mailer/reset_password_instructions.html.erb
================
<p>Hello <%= @resource.email %>!</p>

<p>Someone has requested a link to change your password. You can do this through the link below.</p>

<p><%= link_to 'Change my password', edit_password_url(@resource, reset_password_token: @token) %></p>

<p>If you didn't request this, please ignore this email.</p>
<p>Your password won't change until you access the link above and create a new one.</p>

================
File: app/views/devise/mailer/unlock_instructions.html.erb
================
<p>Hello <%= @resource.email %>!</p>

<p>Your account has been locked due to an excessive number of unsuccessful sign in attempts.</p>

<p>Click the link below to unlock your account:</p>

<p><%= link_to 'Unlock my account', unlock_url(@resource, unlock_token: @token) %></p>

================
File: app/views/devise/passwords/edit.html.erb
================
<h2>Change your password</h2>

<%= form_for(resource, as: resource_name, url: password_path(resource_name), html: { method: :put }) do |f| %>
  <%= render "devise/shared/error_messages", resource: resource %>
  <%= f.hidden_field :reset_password_token %>

  <div class="field">
    <%= f.label :password, "New password" %><br />
    <% if @minimum_password_length %>
      <em>(<%= @minimum_password_length %> characters minimum)</em><br />
    <% end %>
    <%= f.password_field :password, autofocus: true, autocomplete: "new-password" %>
  </div>

  <div class="field">
    <%= f.label :password_confirmation, "Confirm new password" %><br />
    <%= f.password_field :password_confirmation, autocomplete: "new-password" %>
  </div>

  <div class="actions">
    <%= f.submit "Change my password" %>
  </div>
<% end %>

<%= render "devise/shared/links" %>

================
File: app/views/devise/passwords/new.html.erb
================
<h2>Forgot your password?</h2>

<%= form_for(resource, as: resource_name, url: password_path(resource_name), html: { method: :post }) do |f| %>
  <%= render "devise/shared/error_messages", resource: resource %>

  <div class="field">
    <%= f.label :email %><br />
    <%= f.email_field :email, autofocus: true, autocomplete: "email" %>
  </div>

  <div class="actions">
    <%= f.submit "Send me reset password instructions" %>
  </div>
<% end %>

<%= render "devise/shared/links" %>

================
File: app/views/devise/registrations/edit.html.erb
================
<h2>Edit <%= resource_name.to_s.humanize %></h2>

<%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put }) do |f| %>
  <%= render "devise/shared/error_messages", resource: resource %>

  <div class="field">
    <%= f.label :email %><br />
    <%= f.email_field :email, autofocus: true, autocomplete: "email" %>
  </div>

  <% if devise_mapping.confirmable? && resource.pending_reconfirmation? %>
    <div>Currently waiting confirmation for: <%= resource.unconfirmed_email %></div>
  <% end %>

  <div class="field">
    <%= f.label :password %> <i>(leave blank if you don't want to change it)</i><br />
    <%= f.password_field :password, autocomplete: "new-password" %>
    <% if @minimum_password_length %>
      <br />
      <em><%= @minimum_password_length %> characters minimum</em>
    <% end %>
  </div>

  <div class="field">
    <%= f.label :password_confirmation %><br />
    <%= f.password_field :password_confirmation, autocomplete: "new-password" %>
  </div>

  <div class="field">
    <%= f.label :current_password %> <i>(we need your current password to confirm your changes)</i><br />
    <%= f.password_field :current_password, autocomplete: "current-password" %>
  </div>

  <div class="actions">
    <%= f.submit "Update" %>
  </div>
<% end %>

<h3>Cancel my account</h3>

<div>Unhappy? <%= button_to "Cancel my account", registration_path(resource_name), data: { confirm: "Are you sure?", turbo_confirm: "Are you sure?" }, method: :delete %></div>

<%= link_to "Back", :back %>

================
File: app/views/devise/registrations/new.html.erb
================
<div class="min-h-screen flex items-center justify-center bg-gradient-to-r from-cyan-500 to-blue-500">
  <div class="max-w-md w-full space-y-8 p-10 bg-white rounded-xl shadow-2xl">
    <div>
      <h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">Create an Account</h2>
      <p class="mt-2 text-center text-sm text-gray-600">
        Join us and start managing your projects
      </p>
    </div>
    <%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { class: "mt-8 space-y-6" }) do |f| %>
      <%= render "devise/shared/error_messages", resource: resource %>
      <div class="rounded-md shadow-sm -space-y-px">
        <div>
          <%= f.email_field :email, autofocus: true, autocomplete: "email", class: "appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm", placeholder: "Email address" %>
        </div>
        <div>
          <%= f.password_field :password, autocomplete: "new-password", class: "appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm", placeholder: "Password (#{@minimum_password_length} characters minimum)" %>
        </div>
        <div>
          <%= f.password_field :password_confirmation, autocomplete: "new-password", class: "appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm", placeholder: "Confirm password" %>
        </div>
      </div>

      <div>
        <%= f.submit "Sign up", class: "group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out" %>
      </div>
    <% end %>

    <div class="text-center">
      <p class="mt-2 text-sm text-gray-600">
        Already have an account?
        <%= link_to "Log in", new_session_path(resource_name), class: "font-medium text-indigo-600 hover:text-indigo-500" %>
      </p>
    </div>
  </div>
</div>

================
File: app/views/devise/sessions/new.html.erb
================
<div class="min-h-screen flex items-center justify-center bg-gradient-to-r from-cyan-500 to-blue-500">
  <div class="max-w-md w-full space-y-8 p-10 bg-white rounded-xl shadow-2xl">
    <div>
      <h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">Welcome Back</h2>
      <p class="mt-2 text-center text-sm text-gray-600">
        Log in to your account
      </p>
    </div>
    <%= form_for(resource, as: resource_name, url: session_path(resource_name), html: { class: "mt-8 space-y-6" }) do |f| %>
      <div class="rounded-md shadow-sm -space-y-px">
        <div>
          <%= f.email_field :email, autofocus: true, autocomplete: "email", class: "appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm", placeholder: "Email address" %>
        </div>
        <div>
          <%= f.password_field :password, autocomplete: "current-password", class: "appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm", placeholder: "Password" %>
        </div>
      </div>

      <div class="flex items-center justify-between">
        <% if devise_mapping.rememberable? %>
          <div class="flex items-center">
            <%= f.check_box :remember_me, class: "h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded" %>
            <%= f.label :remember_me, class: "ml-2 block text-sm text-gray-900" %>
          </div>
        <% end %>

        <%= link_to "Forgot password?", new_password_path(resource_name), class: "text-sm text-indigo-600 hover:text-indigo-500" %>
      </div>

      <div>
        <%= f.submit "Log in", class: "group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out" %>
      </div>
    <% end %>

    <div class="text-center">
      <p class="mt-2 text-sm text-gray-600">
        Don't have an account?
        <%= link_to "Sign up", new_registration_path(resource_name), class: "font-medium text-indigo-600 hover:text-indigo-500" %>
      </p>
    </div>
  </div>
</div>

================
File: app/views/devise/shared/_error_messages.html.erb
================
<% if resource.errors.any? %>
  <div id="error_explanation" data-turbo-cache="false">
    <h2>
      <%= I18n.t("errors.messages.not_saved",
                 count: resource.errors.count,
                 resource: resource.class.model_name.human.downcase)
       %>
    </h2>
    <ul>
      <% resource.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
    </ul>
  </div>
<% end %>

================
File: app/views/devise/shared/_links.html.erb
================
<%- if controller_name != 'sessions' %>
  <%= link_to "Log in", new_session_path(resource_name) %><br />
<% end %>

<%- if devise_mapping.registerable? && controller_name != 'registrations' %>
  <%= link_to "Sign up", new_registration_path(resource_name) %><br />
<% end %>

<%- if devise_mapping.recoverable? && controller_name != 'passwords' && controller_name != 'registrations' %>
  <%= link_to "Forgot your password?", new_password_path(resource_name) %><br />
<% end %>

<%- if devise_mapping.confirmable? && controller_name != 'confirmations' %>
  <%= link_to "Didn't receive confirmation instructions?", new_confirmation_path(resource_name) %><br />
<% end %>

<%- if devise_mapping.lockable? && resource_class.unlock_strategy_enabled?(:email) && controller_name != 'unlocks' %>
  <%= link_to "Didn't receive unlock instructions?", new_unlock_path(resource_name) %><br />
<% end %>

<%- if devise_mapping.omniauthable? %>
  <%- resource_class.omniauth_providers.each do |provider| %>
    <%= button_to "Sign in with #{OmniAuth::Utils.camelize(provider)}", omniauth_authorize_path(resource_name, provider), data: { turbo: false } %><br />
  <% end %>
<% end %>

================
File: app/views/devise/unlocks/new.html.erb
================
<h2>Resend unlock instructions</h2>

<%= form_for(resource, as: resource_name, url: unlock_path(resource_name), html: { method: :post }) do |f| %>
  <%= render "devise/shared/error_messages", resource: resource %>

  <div class="field">
    <%= f.label :email %><br />
    <%= f.email_field :email, autofocus: true, autocomplete: "email" %>
  </div>

  <div class="actions">
    <%= f.submit "Resend unlock instructions" %>
  </div>
<% end %>

<%= render "devise/shared/links" %>

================
File: app/views/layouts/_navbar.html.erb
================
<nav>
  <%= link_to "Home", root_path %>
  <% if user_signed_in? %>
    <%= button_to "Sign out", destroy_user_session_path, method: :delete, data: { turbo: false } %>
  <% else %>
    <%= link_to "Sign in", new_user_session_path %>
    <%= link_to "Sign up", new_user_registration_path %>
  <% end %>
</nav>

================
File: app/views/layouts/application.html.erb
================
<!-- app/views/layouts/application.html.erb -->
<!DOCTYPE html>
<html>
  <head>
    <title>AI Product Manager</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    
    <%= stylesheet_link_tag "tailwind", "inter-font", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body class="bg-gray-100">
    <div class="flex h-screen">
      <!-- Left-side Navigation Bar -->
      <nav class="bg-indigo-800 text-white w-16 flex flex-col items-center py-4">
        <!-- AI Product Manager Text Logo -->
        <div class="mb-8 writing-mode-vertical text-xs font-bold">
          <span>AI PM</span>
        </div>
        
        <!-- Navigation Icons -->
        <%= link_to dashboard_path, class: "mb-4 p-2 rounded-lg hover:bg-indigo-700 transition-colors duration-200 #{current_page?(dashboard_path) ? 'bg-indigo-700' : ''}", title: "Dashboard" do %>
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
          </svg>
        <% end %>

        <%= link_to product_ideas_path, class: "p-2 rounded-lg hover:bg-indigo-700 transition-colors duration-200 #{current_page?(product_ideas_path) ? 'bg-indigo-700' : ''}", title: "Product Ideas" do %>
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
          </svg>
        <% end %>
      </nav>

      <!-- Main Content Area -->
      <main class="flex-1 overflow-y-auto p-8">
        <%= yield %>
      </main>
    </div>
  </body>
</html>

<style>
  .writing-mode-vertical {
    writing-mode: vertical-rl;
    text-orientation: upright;
  }
</style>

================
File: app/views/layouts/mailer.html.erb
================
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <%= yield %>
  </body>
</html>

================
File: app/views/layouts/mailer.text.erb
================
<%= yield %>

================
File: app/views/pages/dashboard.html.erb
================
<div class="min-h-screen bg-gradient-to-r from-cyan-500 to-blue-500 py-12 px-4 sm:px-6 lg:px-8">
  <div class="max-w-7xl mx-auto">
    <div class="text-center mb-12">
      <h1 class="text-4xl font-bold text-navy-blue mb-4">10x Your Product Management Work</h1>
      <p class="text-2xl text-blue-100 shadow-text">Here's an overview of your AI Product Manager Recent Activity</p>
    </div>

    <div class="flex flex-col lg:flex-row gap-6">
      <!-- Quick Stats Container -->
      <div class="lg:w-1/3 relative">
        <div class="absolute inset-0 bg-gradient-to-r from-cyan-400 to-blue-500 shadow-lg transform -skew-y-6 sm:skew-y-0 sm:-rotate-6 sm:rounded-3xl"></div>
        <div class="relative bg-white rounded-3xl overflow-hidden">
          <div class="px-4 py-5 sm:p-6">
            <div class="bg-gradient-to-br from-purple-100 to-pink-100 rounded-lg shadow-lg p-6">
              <h2 class="text-xl font-medium text-purple-800 mb-4">Quick Stats</h2>
              <div class="space-y-4">
                <div class="bg-white p-4 rounded-lg shadow-md">
                  <p class="text-sm font-medium text-gray-500">Total Ideas</p>
                  <p class="text-xl font-semibold text-purple-600"><%= ProductIdea.count %></p>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-md">
                  <p class="text-sm font-medium text-gray-500">In Progress</p>
                  <p class="text-xl font-semibold text-pink-600"><%= ProductIdea.where(status: 'In Progress').count %></p>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-md">
                  <p class="text-sm font-medium text-gray-500">Total PRDs</p>
                  <p class="text-xl font-semibold text-indigo-600"><%= Prd.count %></p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Recent Ideas Container -->
      <div class="lg:w-1/3 relative">
        <div class="absolute inset-0 bg-gradient-to-r from-cyan-400 to-blue-500 shadow-lg transform -skew-y-6 sm:skew-y-0 sm:-rotate-6 sm:rounded-3xl"></div>
        <div class="relative bg-white rounded-3xl overflow-hidden">
          <div class="px-4 py-5 sm:p-6">
            <div class="bg-gradient-to-br from-green-100 to-teal-100 rounded-lg shadow-lg p-6">
              <h2 class="text-xl font-medium text-green-800 mb-4">Recent Ideas</h2>
              <ul class="space-y-4">
                <% ProductIdea.order(created_at: :desc).limit(3).each do |idea| %>
                  <li class="bg-white p-4 rounded-lg shadow-md hover:shadow-lg transition duration-300">
                    <h3 class="text-base font-medium text-gray-900"><%= link_to truncate(idea.title, length: 24), idea, class: "hover:text-green-600 transition duration-150" %></h3>
                    <p class="mt-1 text-sm text-gray-500"><%= truncate(idea.description, length: 50) %></p>
                    <div class="mt-2 flex justify-between items-center">
                      <span class="px-2 py-1 text-xs font-semibold rounded-full <%= status_color(idea.status) %>">
                        <%= idea.status %>
                      </span>
                      <%= link_to "View", idea, class: "text-sm text-green-600 hover:text-green-800 font-medium" %>
                    </div>
                  </li>
                <% end %>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <!-- Recent PRD Activity Container -->
      <div class="lg:w-1/3 relative">
        <div class="absolute inset-0 bg-gradient-to-r from-cyan-400 to-blue-500 shadow-lg transform -skew-y-6 sm:skew-y-0 sm:-rotate-6 sm:rounded-3xl"></div>
        <div class="relative bg-white rounded-3xl overflow-hidden">
          <div class="px-4 py-5 sm:p-6">
            <div class="bg-gradient-to-br from-yellow-100 to-orange-100 rounded-lg shadow-lg p-6">
              <h2 class="text-xl font-medium text-orange-800 mb-4">Recent PRD Activity</h2>
              <ul class="space-y-4">
                <% Prd.order(updated_at: :desc).limit(3).each do |prd| %>
                  <li class="bg-white p-4 rounded-lg shadow-md hover:shadow-lg transition duration-300">
                    <h3 class="text-base font-medium text-gray-900"><%= link_to truncate(prd.title, length: 24), product_idea_prd_path(prd.product_idea, prd), class: "hover:text-orange-600 transition duration-150" %></h3>
                    <p class="mt-1 text-sm text-gray-500">
                      <%= prd.created_at == prd.updated_at ? "Created" : "Updated" %> 
                      <%= time_ago_in_words(prd.updated_at) %> ago
                    </p>
                    <div class="mt-2 flex justify-between items-center">
                      <span class="px-2 py-1 text-xs font-semibold rounded-full <%= status_color(prd.status) %>">
                        <%= prd.status %>
                      </span>
                      <%= link_to "View", product_idea_prd_path(prd.product_idea, prd), class: "text-sm text-orange-600 hover:text-orange-800 font-medium" %>
                    </div>
                  </li>
                <% end %>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .shadow-text {
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
  }
  .text-navy-blue {
    color: #000080; /* Navy Blue */
  }
  
  h1.text-navy-blue {
    text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.5);
  } 
</style>

================
File: app/views/pages/home.html.erb
================
<div class="min-h-screen flex items-center justify-center bg-gray-100">
  <div class="max-w-md w-full space-y-8 p-10 bg-white rounded-xl shadow-lg">
    <div>
      <h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">
        AI Product Manager
      </h2>
    </div>
    <div class="mt-8 space-y-6">
      <%= link_to "Log in", new_user_session_path, class: "w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
      <%= link_to "Sign up", new_user_registration_path, class: "mt-4 w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500" %>
    </div>
  </div>
</div>

================
File: app/views/prds/create.html.erb
================
<div>
  <h1 class="font-bold text-4xl">Prds#create</h1>
  <p>Find me in app/views/prds/create.html.erb</p>
</div>

================
File: app/views/prds/edit.html.erb
================
<div class="min-h-screen bg-gradient-to-r from-cyan-500 to-blue-500 py-6 px-4 sm:px-6 lg:px-8">
  <div class="max-w-4xl mx-auto">
    <div class="bg-white shadow-lg rounded-lg overflow-hidden">
      <div class="px-4 py-5 sm:px-6 bg-gradient-to-r from-cyan-600 to-blue-600">
        <h1 class="text-2xl font-bold text-white">Edit PRD</h1>
      </div>
      <div class="px-4 py-5 sm:p-6">
        <%= form_with(model: [@product_idea, @prd], local: true) do |form| %>
          <% if @prd.errors.any? %>
            <div class="mb-4 p-4 bg-red-100 rounded-md">
              <h2 class="text-red-700 text-lg font-semibold"><%= pluralize(@prd.errors.count, "error") %> prohibited this PRD from being saved:</h2>
              <ul class="list-disc list-inside">
                <% @prd.errors.full_messages.each do |message| %>
                  <li class="text-red-700"><%= message %></li>
                <% end %>
              </ul>
            </div>
          <% end %>

          <div class="mb-4">
            <%= form.label :title, class: "block text-sm font-medium text-gray-700" %>
            <%= form.text_field :title, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-cyan-500 focus:ring focus:ring-cyan-500 focus:ring-opacity-50" %>
          </div>

          <div class="mb-4">
            <%= form.label :content, class: "block text-sm font-medium text-gray-700" %>
            <%= form.text_area :content, rows: 20, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-cyan-500 focus:ring focus:ring-cyan-500 focus:ring-opacity-50" %>
          </div>

          <div class="flex justify-end">
            <%= form.submit "Update PRD", class: "inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-cyan-600 hover:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-cyan-500" %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>

================
File: app/views/prds/generating.html.erb
================
<div class="min-h-screen bg-gradient-to-r from-cyan-500 to-blue-500 py-6 flex flex-col justify-center sm:py-12">
  <div class="relative py-3 sm:max-w-xl sm:mx-auto w-full">
    <div class="absolute inset-0 bg-gradient-to-r from-cyan-400 to-light-blue-500 shadow-lg transform -skew-y-6 sm:skew-y-0 sm:-rotate-6 sm:rounded-3xl"></div>
    <div class="relative px-4 py-10 bg-white shadow-lg sm:rounded-3xl sm:p-20">
      <div class="max-w-md mx-auto">
        <h2 class="text-2xl font-semibold text-center text-gray-800 mb-6">Generating PRD</h2>
        <p class="text-center text-gray-600 mb-6">Please wait while we generate your PRD. This may take a few minutes.</p>
        <div class="w-full bg-gray-200 rounded-full h-2.5 mb-4 dark:bg-gray-700">
          <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
        </div>
        <p id="progress-text" class="text-center text-gray-600">0%</p>
        <p id="error-message" class="text-center text-red-600 mt-4"></p>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const progressBar = document.getElementById('progress-bar');
  const progressText = document.getElementById('progress-text');
  let progress = 0;

  function updateProgress() {
    if (progress < 90) {
      progress += 10;
      progressBar.style.width = `${progress}%`;
      progressText.textContent = `${progress}%`;
      setTimeout(updateProgress, 10000); // Update every 10 seconds
    }
  }

  function checkStatus() {
    fetch('<%= check_status_product_idea_prd_path(@product_idea, @prd) %>')
      .then(response => response.json())
      .then(data => {
        console.log('Status check response:', data);
        if (data.status === 'completed') {
          console.log('PRD completed, redirecting to:', data.url);
          progressBar.style.width = '100%';
          progressText.textContent = '100%';
          setTimeout(() => { window.location.href = data.url; }, 1000);
        } else if (data.status === 'failed') {
          console.error('PRD generation failed:', data.error);
          progressBar.style.width = '100%';
          progressBar.classList.remove('bg-blue-600');
          progressBar.classList.add('bg-red-600');
          progressText.textContent = 'Generation failed. Please try again.';
          document.getElementById('error-message').textContent = data.error;
        } else {
          console.log('PRD still generating, current status:', data.status);
          setTimeout(checkStatus, 5000); // Check every 5 seconds
        }
      })
      .catch(error => {
        console.error('Error checking status:', error);
      });
  }

  updateProgress();
  checkStatus();
});
</script>

================
File: app/views/prds/new.html.erb
================
<div class="min-h-screen bg-gradient-to-r from-cyan-500 to-blue-500 py-6 flex flex-col justify-center sm:py-12">
  <div class="relative py-3 sm:max-w-xl sm:mx-auto w-full">
    <div class="absolute inset-0 bg-gradient-to-r from-cyan-400 to-light-blue-500 shadow-lg transform -skew-y-6 sm:skew-y-0 sm:-rotate-6 sm:rounded-3xl"></div>
    <div class="relative px-4 py-10 bg-white shadow-lg sm:rounded-3xl sm:p-20">
      <div class="max-w-md mx-auto">
        <h1 class="text-2xl font-semibold mb-6">Generate PRD for <%= @product_idea.title %></h1>
        <%= form_with(model: [@product_idea, @prd], local: true, class: "space-y-4") do |form| %>
          <div>
            <%= form.label :title, class: "block text-sm font-medium text-gray-700" %>
            <%= form.text_field :title, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50" %>
          </div>

          <%= form.submit "Generate PRD", class: "w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
        <% end %>
      </div>
    </div>
  </div>
</div>

================
File: app/views/prds/show.html.erb
================
<div class="min-h-screen bg-gradient-to-r from-cyan-500 to-blue-500 py-6 px-4 sm:px-6 lg:px-8">
  <div class="max-w-4xl mx-auto">
    <div class="bg-white shadow-lg rounded-lg overflow-hidden">
      <div class="px-4 py-5 sm:px-6 bg-gradient-to-r from-cyan-600 to-blue-600">
        <h1 class="text-2xl font-bold text-white"><%= @prd.title %></h1>
        <p class="mt-1 max-w-2xl text-sm text-cyan-100">PRD for <%= @product_idea.title %></p>
      </div>
      
      <div class="px-4 py-5 sm:p-6">
        <div class="mb-4">
          <span class="px-2 py-1 text-xs font-semibold rounded-full <%= status_color(@prd.status) %>">
            <%= @prd.status %>
          </span>
        </div>
        
        <div class="prose max-w-none h-[60vh] overflow-y-auto pr-4 styled-scrollbar">
          <%= simple_format(@prd.content) %>
        </div>
      </div>
      
      <div class="px-4 py-4 sm:px-6 bg-gray-50 flex justify-between items-center">
        <%= link_to "Back to Product Idea", product_idea_path(@product_idea), class: "inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-indigo-700 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
        <%= link_to "Edit PRD", edit_product_idea_prd_path(@product_idea, @prd), class: "inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
        <%= button_to "Start Copilot Conversation", 
              product_idea_prd_product_manager_copilot_index_path(@prd.product_idea, @prd), 
              method: :post, 
              class: "inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
      </div>
    </div>
  </div>
</div>



<style>
  .styled-scrollbar::-webkit-scrollbar {
    width: 8px;
  }
  .styled-scrollbar::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 4px;
  }
  .styled-scrollbar::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 4px;
  }
  .styled-scrollbar::-webkit-scrollbar-thumb:hover {
    background: #555;
  }
</style>

================
File: app/views/product_ideas/_form.html.erb
================
<%= form_with(model: product_idea, local: true) do |form| %>
    <% if product_idea.errors.any? %>
      <div id="error_explanation" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
        <h2><%= pluralize(product_idea.errors.count, "error") %> prohibited this product idea from being saved:</h2>
        <ul>
          <% product_idea.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>
  
    <div class="mb-4">
      <%= form.label :title, class: "block text-gray-700 text-sm font-bold mb-2" %>
      <%= form.text_field :title, class: "shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" %>
    </div>
  
    <div class="mb-4">
      <%= form.label :description, class: "block text-gray-700 text-sm font-bold mb-2" %>
      <%= form.text_area :description, class: "shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" %>
    </div>
  
    <div class="mb-4">
      <%= form.label :customer_acv, "Customer ACV ($)", class: "block text-gray-700 text-sm font-bold mb-2" %>
      <%= form.number_field :customer_acv, step: 0.01, class: "shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" %>
    </div>
  
    <div class="mb-4">
      <%= form.label :customer_impact, class: "block text-gray-700 text-sm font-bold mb-2" %>
      <%= form.text_field :customer_impact, class: "shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" %>
    </div>
  
    <div class="mb-4">
      <%= form.label :tshirt_size_effort, "T-Shirt Size Effort", class: "block text-gray-700 text-sm font-bold mb-2" %>
      <%= form.select :tshirt_size_effort, ['XS', 'S', 'M', 'L', 'XL', 'XXL'], { include_blank: true }, class: "shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" %>
    </div>
  
    <div class="mb-4">
      <%= form.label :status, class: "block text-gray-700 text-sm font-bold mb-2" %>
      <%= form.select :status, ['New', 'In Progress', 'Completed'], {}, class: "shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" %>
    </div>
  
    <div class="flex items-center justify-between">
      <%= form.submit "Create Product Idea", class: "bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" %>
    </div>
  <% end %>

================
File: app/views/product_ideas/create.html.erb
================
<h1>ProductIdeas#create</h1>
<p>Find me in app/views/product_ideas/create.html.erb</p>

================
File: app/views/product_ideas/destroy.html.erb
================
<h1>ProductIdeas#destroy</h1>
<p>Find me in app/views/product_ideas/destroy.html.erb</p>

================
File: app/views/product_ideas/edit.html.erb
================
<div class="min-h-screen bg-gradient-to-r from-cyan-500 to-blue-500 py-6 flex flex-col justify-center sm:py-12">
  <div class="relative py-3 sm:max-w-xl sm:mx-auto w-full">
    <div class="absolute inset-0 bg-gradient-to-r from-cyan-400 to-light-blue-500 shadow-lg transform -skew-y-6 sm:skew-y-0 sm:-rotate-6 sm:rounded-3xl"></div>
    <div class="relative px-4 py-10 bg-white shadow-lg sm:rounded-3xl sm:p-20">
      <div class="max-w-md mx-auto">
        <h1 class="text-2xl font-semibold mb-6 text-center">Edit Product Idea</h1>

        <%= form_with(model: @product_idea, local: true, class: "space-y-6") do |form| %>
          <% if @product_idea.errors.any? %>
            <div class="bg-red-50 p-4 rounded-md">
              <h2 class="text-red-800 text-sm font-medium"><%= pluralize(@product_idea.errors.count, "error") %> prohibited this product idea from being saved:</h2>
              <ul class="mt-3 list-disc list-inside text-sm text-red-600">
                <% @product_idea.errors.full_messages.each do |message| %>
                  <li><%= message %></li>
                <% end %>
              </ul>
            </div>
          <% end %>

          <div>
            <%= form.label :title, class: "block text-sm font-medium text-gray-700" %>
            <%= form.text_field :title, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50" %>
          </div>

          <div>
            <%= form.label :description, class: "block text-sm font-medium text-gray-700" %>
            <%= form.text_area :description, rows: 3, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50" %>
          </div>

          <div>
            <%= form.label :customer_acv, "Customer ACV ($)", class: "block text-sm font-medium text-gray-700" %>
            <%= form.number_field :customer_acv, step: 0.01, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50" %>
          </div>

          <div>
            <%= form.label :customer_impact, class: "block text-sm font-medium text-gray-700" %>
            <%= form.text_field :customer_impact, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50" %>
          </div>

          <div>
            <%= form.label :tshirt_size_effort, "T-Shirt Size Effort", class: "block text-sm font-medium text-gray-700" %>
            <%= form.select :tshirt_size_effort, ['XS', 'S', 'M', 'L', 'XL', 'XXL'], { include_blank: true }, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50" %>
          </div>

          <div>
            <%= form.label :status, class: "block text-sm font-medium text-gray-700" %>
            <%= form.select :status, ['New', 'In Progress', 'Completed'], {}, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50" %>
          </div>

          <div class="flex items-center justify-between">
            <%= form.submit "Update Product Idea", class: "inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
            <%= link_to "Cancel", product_idea_path(@product_idea), class: "inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>

================
File: app/views/product_ideas/index.html.erb
================
<div class="min-h-screen bg-gradient-to-r from-cyan-500 to-blue-500 py-6 flex flex-col justify-center sm:py-12">
  <div class="relative py-3 sm:max-w-5xl sm:mx-auto w-full">
    <div class="absolute inset-0 bg-gradient-to-r from-cyan-400 to-light-blue-500 shadow-lg transform -skew-y-6 sm:skew-y-0 sm:-rotate-6 sm:rounded-3xl"></div>
    <div class="relative px-4 py-10 bg-white shadow-lg sm:rounded-3xl sm:p-20">
      <div class="max-w-5xl mx-auto">
        <div class="flex flex-col md:flex-row gap-8">
          <!-- Create Idea Form -->
          <div class="md:w-1/3">
            <h2 class="text-2xl font-semibold mb-4">Create New Idea</h2>
            <%= form_with(model: ProductIdea.new, local: true, class: "space-y-4") do |form| %>
              <div>
                <%= form.label :title, class: "block text-sm font-medium text-gray-700" %>
                <%= form.text_field :title, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50" %>
              </div>

              <div>
                <%= form.label :description, class: "block text-sm font-medium text-gray-700" %>
                <%= form.text_area :description, rows: 3, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50" %>
              </div>

              <div>
                <%= form.label :customer_acv, "Customer ACV ($)", class: "block text-sm font-medium text-gray-700" %>
                <%= form.number_field :customer_acv, step: 0.01, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50" %>
              </div>

              <div>
                <%= form.label :customer_impact, class: "block text-sm font-medium text-gray-700" %>
                <%= form.text_field :customer_impact, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50" %>
              </div>

              <div>
                <%= form.label :tshirt_size_effort, "T-Shirt Size Effort", class: "block text-sm font-medium text-gray-700" %>
                <%= form.select :tshirt_size_effort, ['XS', 'S', 'M', 'L', 'XL', 'XXL'], { include_blank: true }, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50" %>
              </div>

              <div>
                <%= form.label :status, class: "block text-sm font-medium text-gray-700" %>
                <%= form.select :status, ['New', 'In Progress', 'Completed'], {}, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50" %>
              </div>

              <%= form.submit "Create Idea", class: "w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
            <% end %>
          </div>

          <!-- List of Product Ideas -->
          <!-- List of Product Ideas -->
<div class="md:w-2/3">
  <h2 class="text-2xl font-semibold mb-4">Product Ideas</h2>
  <div class="h-[calc(100vh-16rem)] overflow-y-auto pr-4"> <!-- Adjust the height as needed -->
    <ul class="space-y-4">
      <% @product_ideas.each do |idea| %>
        <li class="bg-gradient-to-r from-yellow-100 to-orange-100 rounded-lg shadow-md p-6 hover:shadow-lg transition duration-300 ease-in-out border-l-4 border-orange-500">
          <div class="flex justify-between items-start mb-4">
            <h3 class="text-lg font-medium text-gray-900">
              <%= link_to idea.title, idea, class: "hover:text-orange-600 transition duration-150 ease-in-out" %>
            </h3>
            <span class="px-3 py-1 text-xs font-semibold rounded-full <%= status_color(idea.status) %> shadow">
              <%= idea.status %>
            </span>
          </div>
          <p class="text-sm text-gray-700 mb-4"><%= truncate(idea.description, length: 100) %></p>
          <div class="flex justify-between items-center">
            <span class="text-xs text-gray-500 bg-white px-2 py-1 rounded-full shadow-sm">
              Created <%= time_ago_in_words(idea.created_at) %> ago
            </span>
            <div class="flex items-center space-x-2">
              <%= link_to edit_product_idea_path(idea), class: "text-blue-600 hover:text-blue-800 bg-blue-100 p-2 rounded-full transition duration-150 ease-in-out" do %>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                  <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z" />
                </svg>
              <% end %>
              <%= button_to product_idea_path(idea), method: :delete, data: { confirm: 'Are you sure you want to delete this idea?' }, class: "text-red-600 hover:text-red-800 bg-red-100 p-2 rounded-full transition duration-150 ease-in-out" do %>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" />
                </svg>
              <% end %>
              <%= link_to new_product_idea_prd_path(idea), class: "inline-flex items-center px-3 py-2 border border-transparent text-xs font-medium rounded-md text-white bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-cyan-500 shadow-md transition duration-150 ease-in-out" do %>
                <svg class="h-4 w-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                </svg>
                Generate PRD
              <% end %>
            </div>
          </div>
        </li>
      <% end %>
    </ul>
  </div>
</div>
        </div>
      </div>
    </div>
  </div>
</div>

================
File: app/views/product_ideas/new.html.erb
================
<div class="container mx-auto px-4">
  <h1 class="text-2xl font-bold mb-4">New Product Idea</h1>

  <%= render 'form', product_idea: @product_idea %>

  <%= link_to 'Back', product_ideas_path, class: "mt-4 inline-block bg-gray-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700" %>
</div>

================
File: app/views/product_ideas/show.html.erb
================
<div class="min-h-screen bg-gradient-to-r from-cyan-500 to-blue-500 py-6 px-4 sm:px-6 lg:px-8">
  <div class="max-w-4xl mx-auto">
    <div class="bg-gradient-to-br from-yellow-100 to-orange-100 shadow-lg rounded-lg overflow-hidden">
      <div class="px-4 py-5 sm:px-6 bg-gradient-to-r from-yellow-400 to-orange-500">
        <h1 class="text-2xl font-bold text-white">Product Idea: <%= @product_idea.title %></h1>
      </div>
      
      <div class="px-4 py-5 sm:p-6">
        <div class="mb-6 p-4 bg-white rounded-lg shadow-inner">
          <h2 class="text-lg font-semibold text-gray-900 mb-2">Description</h2>
          <p class="text-gray-700"><%= @product_idea.description %></p>
        </div>

        <dl class="grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2">
          <div class="bg-white p-4 rounded-lg shadow-sm">
            <dt class="text-sm font-medium text-gray-500">Customer ACV</dt>
            <dd class="mt-1 text-lg font-semibold text-gray-900">$<%= number_with_precision(@product_idea.customer_acv, precision: 2) %></dd>
          </div>
          
          <div class="bg-white p-4 rounded-lg shadow-sm">
            <dt class="text-sm font-medium text-gray-500">Customer Impact</dt>
            <dd class="mt-1 text-lg font-semibold text-gray-900"><%= @product_idea.customer_impact %></dd>
          </div>
          
          <div class="bg-white p-4 rounded-lg shadow-sm">
            <dt class="text-sm font-medium text-gray-500">T-Shirt Size Effort</dt>
            <dd class="mt-1 text-lg font-semibold text-gray-900"><%= @product_idea.tshirt_size_effort %></dd>
          </div>
          
          <div class="bg-white p-4 rounded-lg shadow-sm">
            <dt class="text-sm font-medium text-gray-500">Status</dt>
            <dd class="mt-1">
              <span class="px-2 py-1 text-sm font-semibold rounded-full <%= status_color(@product_idea.status) %>">
                <%= @product_idea.status %>
              </span>
            </dd>
          </div>
        </dl>
      </div>
    </div>
    
    <div class="mt-8 bg-white shadow-lg rounded-lg overflow-hidden">
      <div class="px-4 py-5 sm:px-6 bg-gradient-to-r from-cyan-600 to-blue-600">
        <h2 class="text-xl font-semibold text-white">Generated PRDs</h2>
      </div>
      
      <div class="px-4 py-5 sm:p-6">
        <% if @product_idea.prds.any? %>
          <ul class="divide-y divide-gray-200">
            <% @product_idea.prds.each do |prd| %>
              <li class="py-4">
                <div class="flex items-center justify-between">
                  <div class="flex items-center">
                    <div class="flex-shrink-0">
                      <svg class="h-8 w-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      </svg>
                    </div>
                    <div class="ml-4">
                      <h3 class="text-lg font-medium text-gray-900"><%= prd.title.presence || "Untitled PRD" %></h3>
                      <p class="text-sm text-gray-500"><%= prd.status&.capitalize || 'N/A' %></p>
                    </div>
                  </div>
                  <div>
                    <%= link_to "View", product_idea_prd_path(@product_idea, prd), class: "inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-indigo-700 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
                  </div>
                </div>
              </li>
            <% end %>
          </ul>
        <% else %>
          <p class="text-gray-500 text-center py-4">No PRDs generated yet.</p>
        <% end %>
      </div>
      
      <div class="px-4 py-4 sm:px-6 bg-gray-50">
        <%= link_to "Generate New PRD", new_product_idea_prd_path(@product_idea), class: "inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
      </div>
    </div>
    
    <div class="mt-6 flex justify-between">
      <%= link_to "Edit Product Idea", edit_product_idea_path(@product_idea), class: "inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
      <%= link_to "Back to Product Ideas", product_ideas_path, class: "inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-indigo-700 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
    </div>
  </div>
</div>

================
File: app/views/product_ideas/update.html.erb
================
<h1>ProductIdeas#update</h1>
<p>Find me in app/views/product_ideas/update.html.erb</p>

================
File: app/views/product_manager_copilot/show.html.erb
================
<!-- app/views/product_manager_copilot/show.html.erb -->
<div class="min-h-screen bg-gradient-to-r from-cyan-500 to-blue-500 py-6 px-4 sm:px-6 lg:px-8">
  <div class="max-w-7xl mx-auto space-y-6">
    <!-- Copilot Card -->
    <div class="w-full">
      <div class="bg-gradient-to-br from-yellow-100 to-orange-100 shadow-lg rounded-lg overflow-hidden">
        <div class="px-4 py-5 sm:px-6 bg-gradient-to-r from-yellow-400 to-orange-500 flex items-center">
          <div class="bg-white rounded-full p-1 mr-3">
            <svg class="w-6 h-6 text-orange-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg>
          </div>
          <h2 class="text-xl font-bold text-white">AI Product Manager Copilot</h2>
        </div>
        <div class="p-6 max-h-[30vh] overflow-y-auto">
          <div id="conversation" class="styled-scrollbar">
            <% if @messages.empty? %>
              <div class="text-center">
                <h3 class="text-xl font-semibold mb-2 text-orange-800">Ask AI Copilot anything</h3>
                <p class="text-orange-700 mb-4">The AI Copilot can help you improve your PRD. Choose from the prompts below or write your own.</p>
                <div class="flex flex-wrap justify-center gap-2">
                  <button onclick="sendPrompt(this.textContent)" class="prompt-chip bg-white text-orange-700 px-4 py-2 rounded-full text-sm font-medium shadow-sm hover:bg-orange-50 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 border border-orange-300">Improve PRD structure</button>
                  <button onclick="sendPrompt(this.textContent)" class="prompt-chip bg-white text-orange-700 px-4 py-2 rounded-full text-sm font-medium shadow-sm hover:bg-orange-50 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 border border-orange-300">Clarify requirements</button>
                  <button onclick="sendPrompt(this.textContent)" class="prompt-chip bg-white text-orange-700 px-4 py-2 rounded-full text-sm font-medium shadow-sm hover:bg-orange-50 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 border border-orange-300">Suggest features</button>
                  <button onclick="sendPrompt(this.textContent)" class="prompt-chip bg-white text-orange-700 px-4 py-2 rounded-full text-sm font-medium shadow-sm hover:bg-orange-50 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 border border-orange-300">Review PRD</button>
                </div>
              </div>
            <% else %>
              <% @messages.each do |message| %>
                <div class="<%= message.role == 'user' ? 'text-right' : 'text-left' %> mb-2">
                  <span class="inline-block <%= message.role == 'user' ? 'bg-orange-200' : 'bg-yellow-200' %> rounded-lg px-4 py-2 shadow">
                    <%= message.content %>
                  </span>
                </div>
              <% end %>
            <% end %>
          </div>

          <%= form_with(url: product_idea_prd_product_manager_copilot_path(@product_idea, @prd, @conversation), method: :patch, local: true, class: "mt-4") do |f| %>
            <div class="relative">
              <%= f.text_area :message, rows: 2, class: "w-full rounded-md border-orange-300 shadow-sm focus:border-orange-500 focus:ring focus:ring-orange-200 focus:ring-opacity-50 pr-12", placeholder: "Ask AI Copilot anything..." %>
              <button type="submit" class="absolute bottom-2 right-2 text-orange-500 hover:text-orange-600">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 5l7 7-7 7"></path></svg>
              </button>
            </div>
          <% end %>
        </div>
      </div>
    </div>

    <!-- PRD Card -->
    <div class="w-full">
    <div class="bg-white shadow-lg rounded-lg overflow-hidden">
      <div class="px-4 py-5 sm:px-6 bg-gradient-to-r from-cyan-600 to-blue-600">
        <h2 class="text-xl font-bold text-white">PRD: <%= @prd.title %></h2>
      </div>
      <div class="p-6 h-[calc(100vh-300px)] overflow-y-auto">
        <div id="prd-content" class="prose max-w-none space-y-6">
          <%= sanitize(@prd.content, tags: %w(h1 h2 h3 h4 h5 h6 p ul ol li strong em br), attributes: %w(id class)) %>
        </div>
      </div>
    </div>
  </div>

<style>
  .styled-scrollbar::-webkit-scrollbar {
    width: 8px;
  }
  .styled-scrollbar::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 4px;
  }
  .styled-scrollbar::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 4px;
  }
  .styled-scrollbar::-webkit-scrollbar-thumb:hover {
    background: #555;
  }
  
  .prose h1 { @apply text-3xl font-bold mt-8 mb-4; }
  .prose h2 { @apply text-2xl font-semibold mt-6 mb-3; }
  .prose h3 { @apply text-xl font-medium mt-5 mb-2; }
  .prose h4 { @apply text-lg font-medium mt-4 mb-2; }
  .prose h5 { @apply text-base font-medium mt-3 mb-1; }
  .prose h6 { @apply text-sm font-medium mt-3 mb-1; }
  .prose p { @apply my-4; }
  .prose ul, .prose ol { @apply my-4 pl-8; }
  .prose li { @apply my-2; }
  .prose strong { @apply font-semibold; }
  .prose em { @apply italic; }
</style>

<script>
  function sendPrompt(prompt) {
    const form = document.querySelector('form');
    const input = form.querySelector('textarea[name="message"]');
    input.value = prompt;
    submitForm(form);
  }

  function submitForm(form) {
    const url = form.action;
    const formData = new FormData(form);

    fetch(url, {
      method: 'PATCH',
      body: formData,
      headers: {
        'X-CSRF-Token': document.querySelector('meta[name="csrf-token"]').content,
        'Accept': 'application/json'
      }
    })
    .then(response => response.json())
    .then(data => {
      updateConversation(formData.get('message'), data.response);
      updatePRDContent(data.updated_prd_content);
      form.reset();
    })
    .catch(error => console.error('Error:', error));
  }

  function updateConversation(userMessage, aiResponse) {
    const conversation = document.getElementById('conversation');
    conversation.innerHTML += `
      <div class="text-right mb-2">
        <span class="inline-block bg-orange-200 rounded-lg px-4 py-2 shadow">
          ${userMessage}
        </span>
      </div>
      <div class="text-left mb-2">
        <span class="inline-block bg-yellow-200 rounded-lg px-4 py-2 shadow">
          ${aiResponse}
        </span>
      </div>
    `;
    scrollToBottom();
  }

  function updatePRDContent(newContent) {
    const prdContent = document.getElementById('prd-content');
    prdContent.innerHTML = newContent;
  }

  function scrollToBottom() {
    var conversation = document.getElementById('conversation');
    conversation.scrollTop = conversation.scrollHeight;
  }

  document.addEventListener('DOMContentLoaded', function() {
    scrollToBottom();

    const form = document.querySelector('form');
    form.addEventListener('submit', function(e) {
      e.preventDefault();
      submitForm(this);
    });

    // Set up prompt chip listeners
    document.querySelectorAll('.prompt-chip').forEach(chip => {
      chip.addEventListener('click', function() {
        sendPrompt(this.textContent);
        this.disabled = true;
        this.classList.add('opacity-50', 'cursor-not-allowed');
      });
    });
  });
</script>

================
File: app/views/pwa/manifest.json.erb
================
{
  "name": "AiProductManager",
  "icons": [
    {
      "src": "/icon.png",
      "type": "image/png",
      "sizes": "512x512"
    },
    {
      "src": "/icon.png",
      "type": "image/png",
      "sizes": "512x512",
      "purpose": "maskable"
    }
  ],
  "start_url": "/",
  "display": "standalone",
  "scope": "/",
  "description": "AiProductManager.",
  "theme_color": "red",
  "background_color": "red"
}

================
File: app/views/pwa/service-worker.js
================
// Add a service worker for processing Web Push notifications:
//
// self.addEventListener("push", async (event) => {
//   const { title, options } = await event.data.json()
//   event.waitUntil(self.registration.showNotification(title, options))
// })
//
// self.addEventListener("notificationclick", function(event) {
//   event.notification.close()
//   event.waitUntil(
//     clients.matchAll({ type: "window" }).then((clientList) => {
//       for (let i = 0; i < clientList.length; i++) {
//         let client = clientList[i]
//         let clientPath = (new URL(client.url)).pathname
//
//         if (clientPath == event.notification.data.path && "focus" in client) {
//           return client.focus()
//         }
//       }
//
//       if (clients.openWindow) {
//         return clients.openWindow(event.notification.data.path)
//       }
//     })
//   )
// })

================
File: app/views/shared/_navbar.html.erb
================
<nav class="bg-gradient-to-r from-cyan-500 to-blue-500">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-16">
      <div class="flex items-center">
        <div class="flex-shrink-0">
          <%= link_to root_path, class: "text-white font-bold text-xl" do %>
            AI Product Manager
          <% end %>
        </div>
        <div class="hidden md:block">
          <div class="ml-10 flex items-baseline space-x-4">
            <%= link_to "Dashboard", root_path, class: "text-white hover:bg-cyan-600 hover:text-white px-3 py-2 rounded-md text-sm font-medium" %>
            <%= link_to "Product Ideas", product_ideas_path, class: "text-white hover:bg-cyan-600 hover:text-white px-3 py-2 rounded-md text-sm font-medium" %>
          </div>
        </div>
      </div>
      <div class="hidden md:block">
        <div class="ml-4 flex items-center md:ml-6">
          <% if user_signed_in? %>
            <div class="ml-3 relative">
              <div>
                <button type="button" class="max-w-xs bg-gray-200 rounded-full flex items-center text-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-cyan-600 focus:ring-white" id="user-menu-button" aria-expanded="false" aria-haspopup="true">
                  <span class="sr-only">Open user menu</span>
                  <img class="h-8 w-8 rounded-full" src="https://ui-avatars.com/api/?name=<%= current_user.email[0] %>&background=random" alt="">
                </button>
              </div>
              <div id="user-menu" class="origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5 focus:outline-none hidden" role="menu" aria-orientation="vertical" aria-labelledby="user-menu-button" tabindex="-1">
                <%= link_to "Profile", "#", class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100", role: "menuitem", tabindex: "-1" %>
                <%= link_to "Integrations", "#", class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100", role: "menuitem", tabindex: "-1" %>
                <%= link_to "Log out", destroy_user_session_path, method: :delete, data: { turbo_method: :delete }, class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100", role: "menuitem", tabindex: "-1" %>
              </div>
            </div>
          <% else %>
            <%= link_to "Sign in", new_user_session_path, class: "text-white hover:bg-cyan-600 hover:text-white px-3 py-2 rounded-md text-sm font-medium" %>
            <%= link_to "Sign up", new_user_registration_path, class: "text-white bg-cyan-600 hover:bg-cyan-700 px-3 py-2 rounded-md text-sm font-medium ml-2" %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</nav>

<script>
  document.addEventListener('DOMContentLoaded', (event) => {
    const userMenuButton = document.getElementById('user-menu-button');
    const userMenu = document.getElementById('user-menu');

    if (userMenuButton && userMenu) {
      userMenuButton.addEventListener('click', () => {
        userMenu.classList.toggle('hidden');
      });

      document.addEventListener('click', (event) => {
        if (!userMenuButton.contains(event.target) && !userMenu.contains(event.target)) {
          userMenu.classList.add('hidden');
        }
      });
    }
  });
</script>

================
File: app/views/shared/_notification.html.erb
================
<!-- app/views/shared/_notification.html.erb -->
<div id="notification-<%= SecureRandom.hex(8) %>" 
     class="notification fixed bottom-8 right-8 w-80 bg-white border-l-4 <%= type == 'alert' ? 'border-red-500' : 'border-green-500' %> rounded-lg shadow-2xl transform translate-y-full opacity-0 transition-all duration-500 ease-out" 
     data-controller="notification"
     style="z-index: 9999;">
  <div class="p-4">
    <div class="flex items-start">
      <div class="flex-shrink-0">
        <% if type == "notice" %>
          <svg class="w-6 h-6 text-green-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        <% else %>
          <svg class="w-6 h-6 text-red-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
          </svg>
        <% end %>
      </div>
      <div class="ml-3 w-0 flex-1">
        <p class="text-sm leading-5 font-medium text-gray-900"><%= message %></p>
      </div>
      <div class="ml-4 flex-shrink-0 flex">
        <button data-action="notification#hide" class="inline-flex text-gray-400 focus:outline-none focus:text-gray-500 transition ease-in-out duration-150">
          <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
          </svg>
        </button>
      </div>
    </div>
  </div>
</div>

================
File: bin/brakeman
================
#!/usr/bin/env ruby.exe
require "rubygems"
require "bundler/setup"

ARGV.unshift("--ensure-latest")

load Gem.bin_path("brakeman", "brakeman")

================
File: bin/bundle
================
#!/usr/bin/env ruby
# frozen_string_literal: true

#
# This file was generated by Bundler.
#
# The application 'bundle' is installed as part of a gem, and
# this file is here to facilitate running it.
#

require "rubygems"

m = Module.new do
  module_function

  def invoked_as_script?
    File.expand_path($0) == File.expand_path(__FILE__)
  end

  def env_var_version
    ENV["BUNDLER_VERSION"]
  end

  def cli_arg_version
    return unless invoked_as_script? # don't want to hijack other binstubs
    return unless "update".start_with?(ARGV.first || " ") # must be running `bundle update`
    bundler_version = nil
    update_index = nil
    ARGV.each_with_index do |a, i|
      if update_index && update_index.succ == i && a.match?(Gem::Version::ANCHORED_VERSION_PATTERN)
        bundler_version = a
      end
      next unless a =~ /\A--bundler(?:[= ](#{Gem::Version::VERSION_PATTERN}))?\z/
      bundler_version = $1
      update_index = i
    end
    bundler_version
  end

  def gemfile
    gemfile = ENV["BUNDLE_GEMFILE"]
    return gemfile if gemfile && !gemfile.empty?

    File.expand_path("../Gemfile", __dir__)
  end

  def lockfile
    lockfile =
      case File.basename(gemfile)
      when "gems.rb" then gemfile.sub(/\.rb$/, ".locked")
      else "#{gemfile}.lock"
      end
    File.expand_path(lockfile)
  end

  def lockfile_version
    return unless File.file?(lockfile)
    lockfile_contents = File.read(lockfile)
    return unless lockfile_contents =~ /\n\nBUNDLED WITH\n\s{2,}(#{Gem::Version::VERSION_PATTERN})\n/
    Regexp.last_match(1)
  end

  def bundler_requirement
    @bundler_requirement ||=
      env_var_version ||
      cli_arg_version ||
      bundler_requirement_for(lockfile_version)
  end

  def bundler_requirement_for(version)
    return "#{Gem::Requirement.default}.a" unless version

    bundler_gem_version = Gem::Version.new(version)

    bundler_gem_version.approximate_recommendation
  end

  def load_bundler!
    ENV["BUNDLE_GEMFILE"] ||= gemfile

    activate_bundler
  end

  def activate_bundler
    gem_error = activation_error_handling do
      gem "bundler", bundler_requirement
    end
    return if gem_error.nil?
    require_error = activation_error_handling do
      require "bundler/version"
    end
    return if require_error.nil? && Gem::Requirement.new(bundler_requirement).satisfied_by?(Gem::Version.new(Bundler::VERSION))
    warn "Activating bundler (#{bundler_requirement}) failed:\n#{gem_error.message}\n\nTo install the version of bundler this project requires, run `gem install bundler -v '#{bundler_requirement}'`"
    exit 42
  end

  def activation_error_handling
    yield
    nil
  rescue StandardError, LoadError => e
    e
  end
end

m.load_bundler!

if m.invoked_as_script?
  load Gem.bin_path("bundler", "bundle")
end

================
File: bin/bundle.cmd
================
@ruby -x "%~f0" %*
@exit /b %ERRORLEVEL%

#!/usr/bin/env ruby
# frozen_string_literal: true

#
# This file was generated by Bundler.
#
# The application 'bundle' is installed as part of a gem, and
# this file is here to facilitate running it.
#

require "rubygems"

m = Module.new do
  module_function

  def invoked_as_script?
    File.expand_path($0) == File.expand_path(__FILE__)
  end

  def env_var_version
    ENV["BUNDLER_VERSION"]
  end

  def cli_arg_version
    return unless invoked_as_script? # don't want to hijack other binstubs
    return unless "update".start_with?(ARGV.first || " ") # must be running `bundle update`
    bundler_version = nil
    update_index = nil
    ARGV.each_with_index do |a, i|
      if update_index && update_index.succ == i && a.match?(Gem::Version::ANCHORED_VERSION_PATTERN)
        bundler_version = a
      end
      next unless a =~ /\A--bundler(?:[= ](#{Gem::Version::VERSION_PATTERN}))?\z/
      bundler_version = $1
      update_index = i
    end
    bundler_version
  end

  def gemfile
    gemfile = ENV["BUNDLE_GEMFILE"]
    return gemfile if gemfile && !gemfile.empty?

    File.expand_path("../Gemfile", __dir__)
  end

  def lockfile
    lockfile =
      case File.basename(gemfile)
      when "gems.rb" then gemfile.sub(/\.rb$/, ".locked")
      else "#{gemfile}.lock"
      end
    File.expand_path(lockfile)
  end

  def lockfile_version
    return unless File.file?(lockfile)
    lockfile_contents = File.read(lockfile)
    return unless lockfile_contents =~ /\n\nBUNDLED WITH\n\s{2,}(#{Gem::Version::VERSION_PATTERN})\n/
    Regexp.last_match(1)
  end

  def bundler_requirement
    @bundler_requirement ||=
      env_var_version ||
      cli_arg_version ||
      bundler_requirement_for(lockfile_version)
  end

  def bundler_requirement_for(version)
    return "#{Gem::Requirement.default}.a" unless version

    bundler_gem_version = Gem::Version.new(version)

    bundler_gem_version.approximate_recommendation
  end

  def load_bundler!
    ENV["BUNDLE_GEMFILE"] ||= gemfile

    activate_bundler
  end

  def activate_bundler
    gem_error = activation_error_handling do
      gem "bundler", bundler_requirement
    end
    return if gem_error.nil?
    require_error = activation_error_handling do
      require "bundler/version"
    end
    return if require_error.nil? && Gem::Requirement.new(bundler_requirement).satisfied_by?(Gem::Version.new(Bundler::VERSION))
    warn "Activating bundler (#{bundler_requirement}) failed:\n#{gem_error.message}\n\nTo install the version of bundler this project requires, run `gem install bundler -v '#{bundler_requirement}'`"
    exit 42
  end

  def activation_error_handling
    yield
    nil
  rescue StandardError, LoadError => e
    e
  end
end

m.load_bundler!

if m.invoked_as_script?
  load Gem.bin_path("bundler", "bundle")
end

================
File: bin/dev
================
#!/usr/bin/env sh

if ! gem list foreman -i --silent; then
  echo "Installing foreman..."
  gem install foreman
fi

# Default to port 3000 if not specified
export PORT="${PORT:-3000}"

# Let the debug gem allow remote connections,
# but avoid loading until `debugger` is called
export RUBY_DEBUG_OPEN="true"
export RUBY_DEBUG_LAZY="true"

exec foreman start -f Procfile.dev "$@"

================
File: bin/docker-entrypoint
================
#!/bin/bash -e

# Enable jemalloc for reduced memory usage and latency.
if [ -z "${LD_PRELOAD+x}" ] && [ -f /usr/lib/*/libjemalloc.so.2 ]; then
  export LD_PRELOAD="$(echo /usr/lib/*/libjemalloc.so.2)"
fi

# If running the rails server then create or migrate existing database
if [ "${1}" == "./bin/rails" ] && [ "${2}" == "server" ]; then
  ./bin/rails db:prepare
fi

exec "${@}"

================
File: bin/importmap
================
#!/usr/bin/env ruby

require_relative "../config/application"
require "importmap/commands"

================
File: bin/rails
================
#!/usr/bin/env ruby.exe
APP_PATH = File.expand_path("../config/application", __dir__)
require_relative "../config/boot"
require "rails/commands"

================
File: bin/rake
================
#!/usr/bin/env ruby.exe
require_relative "../config/boot"
require "rake"
Rake.application.run

================
File: bin/rubocop
================
#!/usr/bin/env ruby.exe
require "rubygems"
require "bundler/setup"

# explicit rubocop config increases performance slightly while avoiding config confusion.
ARGV.unshift("--config", File.expand_path("../.rubocop.yml", __dir__))

load Gem.bin_path("rubocop", "rubocop")

================
File: bin/setup
================
#!/usr/bin/env ruby.exe
require "fileutils"

APP_ROOT = File.expand_path("..", __dir__)
APP_NAME = "ai-product-manager"

def system!(*args)
  system(*args, exception: true)
end

FileUtils.chdir APP_ROOT do
  # This script is a way to set up or update your development environment automatically.
  # This script is idempotent, so that you can run it at any time and get an expectable outcome.
  # Add necessary setup steps to this file.

  puts "== Installing dependencies =="
  system! "gem install bundler --conservative"
  system("bundle check") || system!("bundle install")

  # puts "\n== Copying sample files =="
  # unless File.exist?("config/database.yml")
  #   FileUtils.cp "config/database.yml.sample", "config/database.yml"
  # end

  puts "\n== Preparing database =="
  system! "bin/rails db:prepare"

  puts "\n== Removing old logs and tempfiles =="
  system! "bin/rails log:clear tmp:clear"

  puts "\n== Restarting application server =="
  system! "bin/rails restart"

  # puts "\n== Configuring puma-dev =="
  # system "ln -nfs #{APP_ROOT} ~/.puma-dev/#{APP_NAME}"
  # system "curl -Is https://#{APP_NAME}.test/up | head -n 1"
end

================
File: config.ru
================
# This file is used by Rack-based servers to start the application.

require_relative "config/environment"

run Rails.application
Rails.application.load_server

================
File: config/application.rb
================
require_relative "boot"

require "rails/all"

# Require the gems listed in Gemfile, including any gems
# you've limited to :test, :development, or :production.
Bundler.require(*Rails.groups)

# Load dotenv only in development or test environment
if ['development', 'test'].include? ENV['RAILS_ENV']
  Dotenv::Rails.load
end

module AiProductManager
  class Application < Rails::Application
    # Initialize configuration defaults for originally generated Rails version.
    config.load_defaults 7.2

    # Please, add to the `config.assets.precompile` list any asset file
    # present in vendor/assets directory of gems, if any.
    # Also, add node_modules to the asset load path.
    config.assets.paths << Rails.root.join("node_modules")

    # Configuration for the application, engines, and railties goes here.
    #
    # These settings can be overridden in specific environments using the files
    # in config/environments, which are processed later.
    #
    # config.time_zone = "Central Time (US & Canada)"
    # config.eager_load_paths << Rails.root.join("extras")

    # Use Sidekiq as the Active Job backend
    config.active_job.queue_adapter = :async

    # Configure i18n to fallback to default locale
    config.i18n.fallbacks = true

    # Enable CSRF protection by default
    config.action_controller.default_protect_from_forgery = true

    # Configure the application to use UUIDs for primary keys
    config.generators do |g|
      g.orm :active_record, primary_key_type: :uuid
    end

    # Enable strict loading of all models by default
    config.active_record.strict_loading_by_default = true

    # Disable automatic generation of helper files
    config.generators.helper = false

    # Configure Action Mailer to use Sidekiq for sending emails
    config.action_mailer.deliver_later_queue_name = nil # Use default queue

    # Configure Active Storage to use Sidekiq for processing variants
    config.active_storage.queues.analysis = nil
    config.active_storage.queues.purge = nil

    # Configure Action Mailbox to use Sidekiq
    config.action_mailbox.queues.incineration = nil
    config.action_mailbox.queues.routing = nil

    # Configure Active Record to use Sidekiq for database tasks
    config.active_record.destroy_association_async_batch_size = 1000
    
    # Add any other custom configurations for your AI Product Manager app here
  end
end

================
File: config/boot.rb
================
ENV["BUNDLE_GEMFILE"] ||= File.expand_path("../Gemfile", __dir__)

require "bundler/setup" # Set up gems listed in the Gemfile.
require "bootsnap/setup" # Speed up boot time by caching expensive operations.

================
File: config/cable.yml
================
development:
  adapter: redis
  url: redis://localhost:6379/1

test:
  adapter: test

production:
  adapter: redis
  url: <%= ENV.fetch("REDIS_URL") { "redis://localhost:6379/1" } %>

================
File: config/credentials.yml.enc
================
Am9j2dKtCIcpJZ1klSx5P4yYZAshi/+DESDZb/ZIp6LwTiDwByUNQiSm1xPsYT2oui5IeYH1B+29DHe+SR4LjuOlBJBMcYciV7gV0Z5ZLz7d2v46xk5kQXCCp4pEEuwGyylQc7eyC3R8zcnTylWllsEBfA3euoLHiLeoao8hqS5RTuwhS18OZHhJu01hp2d4gyWbKWkXrxHx53ABV7+ma1NincqB2NJOkeRP95YnxxllruiSvYnDZWqmSIl6KKsNjQp1++rEeVOeFoJ2q9nWs93SvYoQRgFv/czLK1VgFKRYH8ymoD29uBR0IDgMpcF2ZlrRth59YvAIfuyJ1P9OKBqWa8CPl5AM8DFcjyr4emcmDiASGkoKKGHqluFWL6YWRhjXUuY+ITPiu+lzBedik2tPHv8w--bBp6fjTPh+stHQct--rikM8UdP9sd/Yyl52oT9MA==

================
File: config/database.yml
================
default: &default
  adapter: postgresql
  encoding: unicode
  pool: <%= ENV.fetch("RAILS_MAX_THREADS") { 5 } %>
  username: postgres
  password: Bailey2024!
  host: localhost

development:
  <<: *default
  database: ai_product_manager_development

test:
  <<: *default
  database: ai_product_manager_test

production:
  <<: *default
  database: ai_product_manager_production

================
File: config/environment.rb
================
# Load the Rails application.
require_relative "application"

# Initialize the Rails application.
Rails.application.initialize!

================
File: config/environments/development.rb
================
require "active_support/core_ext/integer/time"

Rails.application.configure do
  # Settings specified here will take precedence over those in config/application.rb.

  # In the development environment your application's code is reloaded any time
  # it changes. This slows down response time but is perfect for development
  # since you don't have to restart the web server when you make code changes.
  config.enable_reloading = true

  # Do not eager load code on boot.
  config.eager_load = false

  # Show full error reports.
  config.consider_all_requests_local = true

  # Enable server timing.
  config.server_timing = true

  # Enable/disable caching. By default caching is disabled.
  # Run rails dev:cache to toggle caching.
  if Rails.root.join("tmp/caching-dev.txt").exist?
    config.action_controller.perform_caching = true
    config.action_controller.enable_fragment_cache_logging = true

    config.cache_store = :memory_store
    config.public_file_server.headers = { "Cache-Control" => "public, max-age=#{2.days.to_i}" }
  else
    config.action_controller.perform_caching = false

    config.cache_store = :null_store
    config.cache_classes = false
  end

  # Store uploaded files on the local file system (see config/storage.yml for options).
  config.active_storage.service = :local

  # Don't care if the mailer can't send.
  config.action_mailer.raise_delivery_errors = false

  # Disable caching for Action Mailer templates even if Action Controller
  # caching is enabled.
  config.action_mailer.perform_caching = false

  config.action_mailer.default_url_options = { host: "localhost", port: 3000 }

  # Print deprecation notices to the Rails logger.
  config.active_support.deprecation = :log

  # Raise exceptions for disallowed deprecations.
  config.active_support.disallowed_deprecation = :raise

  # Tell Active Support which deprecation messages to disallow.
  config.active_support.disallowed_deprecation_warnings = []

  # Raise an error on page load if there are pending migrations.
  config.active_record.migration_error = :page_load

  # Highlight code that triggered database queries in logs.
  config.active_record.verbose_query_logs = true

  # Highlight code that enqueued background job in logs.
  config.active_job.verbose_enqueue_logs = true

  # Suppress logger output for asset requests.
  config.assets.quiet = true

  # Raises error for missing translations.
  # config.i18n.raise_on_missing_translations = true

  # Annotate rendered view with file names.
  config.action_view.annotate_rendered_view_with_filenames = true

  # Uncomment if you wish to allow Action Cable access from any origin.
  # config.action_cable.disable_request_forgery_protection = true

  # Raise error when a before_action's only/except options reference missing actions.
  config.action_controller.raise_on_missing_callback_actions = true

  # Apply autocorrection by RuboCop to files generated by `bin/rails generate`.
  # config.generators.apply_rubocop_autocorrect_after_generate!

  #for devise mailer
  config.action_mailer.default_url_options = { host: 'localhost', port: 3000 }
end

================
File: config/environments/production.rb
================
require "active_support/core_ext/integer/time"

Rails.application.configure do
  # Settings specified here will take precedence over those in config/application.rb.

  # Code is not reloaded between requests.
  config.enable_reloading = false

  # Eager load code on boot. This eager loads most of Rails and
  # your application in memory, allowing both threaded web servers
  # and those relying on copy on write to perform better.
  # Rake tasks automatically ignore this option for performance.
  config.eager_load = true

  # Full error reports are disabled and caching is turned on.
  config.consider_all_requests_local = false
  config.action_controller.perform_caching = true

  # Ensures that a master key has been made available in ENV["RAILS_MASTER_KEY"], config/master.key, or an environment
  # key such as config/credentials/production.key. This key is used to decrypt credentials (and other encrypted files).
  # config.require_master_key = true

  # Disable serving static files from `public/`, relying on NGINX/Apache to do so instead.
  # config.public_file_server.enabled = false

  # Compress CSS using a preprocessor.
  # config.assets.css_compressor = :sass

  # Do not fall back to assets pipeline if a precompiled asset is missed.
  config.assets.compile = false

  # Enable serving of images, stylesheets, and JavaScripts from an asset server.
  # config.asset_host = "http://assets.example.com"

  # Specifies the header that your server uses for sending files.
  # config.action_dispatch.x_sendfile_header = "X-Sendfile" # for Apache
  # config.action_dispatch.x_sendfile_header = "X-Accel-Redirect" # for NGINX

  # Store uploaded files on the local file system (see config/storage.yml for options).
  config.active_storage.service = :local

  # Mount Action Cable outside main process or domain.
  # config.action_cable.mount_path = nil
  # config.action_cable.url = "wss://example.com/cable"
  # config.action_cable.allowed_request_origins = [ "http://example.com", /http:\/\/example.*/ ]

  # Assume all access to the app is happening through a SSL-terminating reverse proxy.
  # Can be used together with config.force_ssl for Strict-Transport-Security and secure cookies.
  # config.assume_ssl = true

  # Force all access to the app over SSL, use Strict-Transport-Security, and use secure cookies.
  config.force_ssl = true

  # Skip http-to-https redirect for the default health check endpoint.
  # config.ssl_options = { redirect: { exclude: ->(request) { request.path == "/up" } } }

  # Log to STDOUT by default
  config.logger = ActiveSupport::Logger.new(STDOUT)
    .tap  { |logger| logger.formatter = ::Logger::Formatter.new }
    .then { |logger| ActiveSupport::TaggedLogging.new(logger) }

  # Prepend all log lines with the following tags.
  config.log_tags = [ :request_id ]

  # "info" includes generic and useful information about system operation, but avoids logging too much
  # information to avoid inadvertent exposure of personally identifiable information (PII). If you
  # want to log everything, set the level to "debug".
  config.log_level = ENV.fetch("RAILS_LOG_LEVEL", "info")

  # Use a different cache store in production.
  # config.cache_store = :mem_cache_store

  # Use a real queuing backend for Active Job (and separate queues per environment).
  # config.active_job.queue_adapter = :resque
  # config.active_job.queue_name_prefix = "ai_product_manager_production"

  # Disable caching for Action Mailer templates even if Action Controller
  # caching is enabled.
  config.action_mailer.perform_caching = false

  # Ignore bad email addresses and do not raise email delivery errors.
  # Set this to true and configure the email server for immediate delivery to raise delivery errors.
  # config.action_mailer.raise_delivery_errors = false

  # Enable locale fallbacks for I18n (makes lookups for any locale fall back to
  # the I18n.default_locale when a translation cannot be found).
  config.i18n.fallbacks = true

  # Don't log any deprecations.
  config.active_support.report_deprecations = false

  # Do not dump schema after migrations.
  config.active_record.dump_schema_after_migration = false

  # Enable DNS rebinding protection and other `Host` header attacks.
  # config.hosts = [
  #   "example.com",     # Allow requests from example.com
  #   /.*\.example\.com/ # Allow requests from subdomains like `www.example.com`
  # ]
  # Skip DNS rebinding protection for the default health check endpoint.
  # config.host_authorization = { exclude: ->(request) { request.path == "/up" } }
end

================
File: config/environments/test.rb
================
require "active_support/core_ext/integer/time"

# The test environment is used exclusively to run your application's
# test suite. You never need to work with it otherwise. Remember that
# your test database is "scratch space" for the test suite and is wiped
# and recreated between test runs. Don't rely on the data there!

Rails.application.configure do
  # Settings specified here will take precedence over those in config/application.rb.

  # While tests run files are not watched, reloading is not necessary.
  config.enable_reloading = false

  # Eager loading loads your entire application. When running a single test locally,
  # this is usually not necessary, and can slow down your test suite. However, it's
  # recommended that you enable it in continuous integration systems to ensure eager
  # loading is working properly before deploying your code.
  config.eager_load = ENV["CI"].present?

  # Configure public file server for tests with Cache-Control for performance.
  config.public_file_server.headers = { "Cache-Control" => "public, max-age=#{1.hour.to_i}" }

  # Show full error reports and disable caching.
  config.consider_all_requests_local = true
  config.action_controller.perform_caching = false
  config.cache_store = :null_store

  # Render exception templates for rescuable exceptions and raise for other exceptions.
  config.action_dispatch.show_exceptions = :rescuable

  # Disable request forgery protection in test environment.
  config.action_controller.allow_forgery_protection = false

  # Store uploaded files on the local file system in a temporary directory.
  config.active_storage.service = :test

  # Disable caching for Action Mailer templates even if Action Controller
  # caching is enabled.
  config.action_mailer.perform_caching = false

  # Tell Action Mailer not to deliver emails to the real world.
  # The :test delivery method accumulates sent emails in the
  # ActionMailer::Base.deliveries array.
  config.action_mailer.delivery_method = :test

  # Unlike controllers, the mailer instance doesn't have any context about the
  # incoming request so you'll need to provide the :host parameter yourself.
  config.action_mailer.default_url_options = { host: "www.example.com" }

  # Print deprecation notices to the stderr.
  config.active_support.deprecation = :stderr

  # Raise exceptions for disallowed deprecations.
  config.active_support.disallowed_deprecation = :raise

  # Tell Active Support which deprecation messages to disallow.
  config.active_support.disallowed_deprecation_warnings = []

  # Raises error for missing translations.
  # config.i18n.raise_on_missing_translations = true

  # Annotate rendered view with file names.
  # config.action_view.annotate_rendered_view_with_filenames = true

  # Raise error when a before_action's only/except options reference missing actions.
  config.action_controller.raise_on_missing_callback_actions = true
end

================
File: config/importmap.rb
================
pin "application", preload: true
pin "@hotwired/turbo-rails", to: "turbo.min.js", preload: true
pin "@hotwired/stimulus", to: "stimulus.min.js", preload: true
pin "@hotwired/stimulus-loading", to: "stimulus-loading.js", preload: true
pin_all_from "app/javascript/controllers", under: "controllers"
pin "@hotwired/stimulus-webpack-helpers", to: "stimulus-webpack-helpers.js", preload: true

================
File: config/initializers/assets.rb
================
# Be sure to restart your server when you modify this file.

# Version of your assets, change this if you want to expire all your assets.
Rails.application.config.assets.version = "1.0"

# Add additional assets to the asset load path.
# Rails.application.config.assets.paths << Emoji.images_path

# Precompile additional assets.
# application.js, application.css, and all non-JS/CSS in the app/assets
# folder are already added.
# Rails.application.config.assets.precompile += %w[ admin.js admin.css ]

================
File: config/initializers/content_security_policy.rb
================
# Be sure to restart your server when you modify this file.

# Define an application-wide content security policy.
# See the Securing Rails Applications Guide for more information:
# https://guides.rubyonrails.org/security.html#content-security-policy-header

# Rails.application.configure do
#   config.content_security_policy do |policy|
#     policy.default_src :self, :https
#     policy.font_src    :self, :https, :data
#     policy.img_src     :self, :https, :data
#     policy.object_src  :none
#     policy.script_src  :self, :https
#     policy.style_src   :self, :https
#     # Specify URI for violation reports
#     # policy.report_uri "/csp-violation-report-endpoint"
#   end
#
#   # Generate session nonces for permitted importmap, inline scripts, and inline styles.
#   config.content_security_policy_nonce_generator = ->(request) { request.session.id.to_s }
#   config.content_security_policy_nonce_directives = %w(script-src style-src)
#
#   # Report violations without enforcing the policy.
#   # config.content_security_policy_report_only = true
# end

================
File: config/initializers/devise.rb
================
# frozen_string_literal: true

# Assuming you have not yet modified this file, each configuration option below
# is set to its default value. Note that some are commented out while others
# are not: uncommented lines are intended to protect your configuration from
# breaking changes in upgrades (i.e., in the event that future versions of
# Devise change the default values for those options).
#
# Use this hook to configure devise mailer, warden hooks and so forth.
# Many of these configuration options can be set straight in your model.
Devise.setup do |config|
  # The secret key used by Devise. Devise uses this key to generate
  # random tokens. Changing this key will render invalid all existing
  # confirmation, reset password and unlock tokens in the database.
  # Devise will use the `secret_key_base` as its `secret_key`
  # by default. You can change it below and use your own secret key.
  # config.secret_key = '92feeb4a2cf21ab0ef4c384b592d97cf982f4b37bc8f115d59a8e72887af46172061881ac305366f9b957593e7598797d90ed0c6e594204cec4d56801dd16f5b'

  # ==> Controller configuration
  # Configure the parent class to the devise controllers.
  # config.parent_controller = 'DeviseController'

  # ==> Mailer Configuration
  # Configure the e-mail address which will be shown in Devise::Mailer,
  # note that it will be overwritten if you use your own mailer class
  # with default "from" parameter.
  config.mailer_sender = 'please-change-me-at-config-initializers-devise@example.com'

  # Configure the default scope given to Warden. By default it's the first
# devise role declared in your routes (usually :user).
  config.default_scope = :user

# Set this configuration to false if you want /users/sign_out to sign out
# only the current scope. By default, Devise signs out all scopes.
  config.sign_out_all_scopes = true

  # Configure the class responsible to send e-mails.
  # config.mailer = 'Devise::Mailer'

  # Configure the parent class responsible to send e-mails.
  # config.parent_mailer = 'ActionMailer::Base'

  # ==> ORM configuration
  # Load and configure the ORM. Supports :active_record (default) and
  # :mongoid (bson_ext recommended) by default. Other ORMs may be
  # available as additional gems.
  require 'devise/orm/active_record'

  # ==> Configuration for any authentication mechanism
  # Configure which keys are used when authenticating a user. The default is
  # just :email. You can configure it to use [:username, :subdomain], so for
  # authenticating a user, both parameters are required. Remember that those
  # parameters are used only when authenticating and not when retrieving from
  # session. If you need permissions, you should implement that in a before filter.
  # You can also supply a hash where the value is a boolean determining whether
  # or not authentication should be aborted when the value is not present.
  # config.authentication_keys = [:email]

  # Configure parameters from the request object used for authentication. Each entry
  # given should be a request method and it will automatically be passed to the
  # find_for_authentication method and considered in your model lookup. For instance,
  # if you set :request_keys to [:subdomain], :subdomain will be used on authentication.
  # The same considerations mentioned for authentication_keys also apply to request_keys.
  # config.request_keys = []

  # Configure which authentication keys should be case-insensitive.
  # These keys will be downcased upon creating or modifying a user and when used
  # to authenticate or find a user. Default is :email.
  config.case_insensitive_keys = [:email]

  # Configure which authentication keys should have whitespace stripped.
  # These keys will have whitespace before and after removed upon creating or
  # modifying a user and when used to authenticate or find a user. Default is :email.
  config.strip_whitespace_keys = [:email]

  # Tell if authentication through request.params is enabled. True by default.
  # It can be set to an array that will enable params authentication only for the
  # given strategies, for example, `config.params_authenticatable = [:database]` will
  # enable it only for database (email + password) authentication.
  # config.params_authenticatable = true

  # Tell if authentication through HTTP Auth is enabled. False by default.
  # It can be set to an array that will enable http authentication only for the
  # given strategies, for example, `config.http_authenticatable = [:database]` will
  # enable it only for database authentication.
  # For API-only applications to support authentication "out-of-the-box", you will likely want to
  # enable this with :database unless you are using a custom strategy.
  # The supported strategies are:
  # :database      = Support basic authentication with authentication key + password
  # config.http_authenticatable = false

  # If 401 status code should be returned for AJAX requests. True by default.
  # config.http_authenticatable_on_xhr = true

  # The realm used in Http Basic Authentication. 'Application' by default.
  # config.http_authentication_realm = 'Application'

  # It will change confirmation, password recovery and other workflows
  # to behave the same regardless if the e-mail provided was right or wrong.
  # Does not affect registerable.
  # config.paranoid = true

  # By default Devise will store the user in session. You can skip storage for
  # particular strategies by setting this option.
  # Notice that if you are skipping storage for all authentication paths, you
  # may want to disable generating routes to Devise's sessions controller by
  # passing skip: :sessions to `devise_for` in your config/routes.rb
  config.skip_session_storage = [:http_auth]

  # By default, Devise cleans up the CSRF token on authentication to
  # avoid CSRF token fixation attacks. This means that, when using AJAX
  # requests for sign in and sign up, you need to get a new CSRF token
  # from the server. You can disable this option at your own risk.
  # config.clean_up_csrf_token_on_authentication = true

  # When false, Devise will not attempt to reload routes on eager load.
  # This can reduce the time taken to boot the app but if your application
  # requires the Devise mappings to be loaded during boot time the application
  # won't boot properly.
  # config.reload_routes = true

  # ==> Configuration for :database_authenticatable
  # For bcrypt, this is the cost for hashing the password and defaults to 12. If
  # using other algorithms, it sets how many times you want the password to be hashed.
  # The number of stretches used for generating the hashed password are stored
  # with the hashed password. This allows you to change the stretches without
  # invalidating existing passwords.
  #
  # Limiting the stretches to just one in testing will increase the performance of
  # your test suite dramatically. However, it is STRONGLY RECOMMENDED to not use
  # a value less than 10 in other environments. Note that, for bcrypt (the default
  # algorithm), the cost increases exponentially with the number of stretches (e.g.
  # a value of 20 is already extremely slow: approx. 60 seconds for 1 calculation).
  config.stretches = Rails.env.test? ? 1 : 12

  # Set up a pepper to generate the hashed password.
  # config.pepper = '161dfa90a48701e2ef05c2dfc54ea0668524d39507720eeb6d7f762d1c0cf52b166ec343cfbf2d3c724d8765a2621e8b4308d27fba8571394ca53585aeb8933f'

  # Send a notification to the original email when the user's email is changed.
  # config.send_email_changed_notification = false

  # Send a notification email when the user's password is changed.
  # config.send_password_change_notification = false

  # ==> Configuration for :confirmable
  # A period that the user is allowed to access the website even without
  # confirming their account. For instance, if set to 2.days, the user will be
  # able to access the website for two days without confirming their account,
  # access will be blocked just in the third day.
  # You can also set it to nil, which will allow the user to access the website
  # without confirming their account.
  # Default is 0.days, meaning the user cannot access the website without
  # confirming their account.
  # config.allow_unconfirmed_access_for = 2.days

  # A period that the user is allowed to confirm their account before their
  # token becomes invalid. For example, if set to 3.days, the user can confirm
  # their account within 3 days after the mail was sent, but on the fourth day
  # their account can't be confirmed with the token any more.
  # Default is nil, meaning there is no restriction on how long a user can take
  # before confirming their account.
  # config.confirm_within = 3.days

  # If true, requires any email changes to be confirmed (exactly the same way as
  # initial account confirmation) to be applied. Requires additional unconfirmed_email
  # db field (see migrations). Until confirmed, new email is stored in
  # unconfirmed_email column, and copied to email column on successful confirmation.
  config.reconfirmable = true

  # Defines which key will be used when confirming an account
  # config.confirmation_keys = [:email]

  # ==> Configuration for :rememberable
  # The time the user will be remembered without asking for credentials again.
  # config.remember_for = 2.weeks

  # Invalidates all the remember me tokens when the user signs out.
  config.expire_all_remember_me_on_sign_out = true

  # If true, extends the user's remember period when remembered via cookie.
  # config.extend_remember_period = false

  # Options to be passed to the created cookie. For instance, you can set
  # secure: true in order to force SSL only cookies.
  # config.rememberable_options = {}

  # ==> Configuration for :validatable
  # Range for password length.
  config.password_length = 6..128

  # Email regex used to validate email formats. It simply asserts that
  # one (and only one) @ exists in the given string. This is mainly
  # to give user feedback and not to assert the e-mail validity.
  config.email_regexp = /\A[^@\s]+@[^@\s]+\z/

  # ==> Configuration for :timeoutable
  # The time you want to timeout the user session without activity. After this
  # time the user will be asked for credentials again. Default is 30 minutes.
  # config.timeout_in = 30.minutes

  # ==> Configuration for :lockable
  # Defines which strategy will be used to lock an account.
  # :failed_attempts = Locks an account after a number of failed attempts to sign in.
  # :none            = No lock strategy. You should handle locking by yourself.
  # config.lock_strategy = :failed_attempts

  # Defines which key will be used when locking and unlocking an account
  # config.unlock_keys = [:email]

  # Defines which strategy will be used to unlock an account.
  # :email = Sends an unlock link to the user email
  # :time  = Re-enables login after a certain amount of time (see :unlock_in below)
  # :both  = Enables both strategies
  # :none  = No unlock strategy. You should handle unlocking by yourself.
  # config.unlock_strategy = :both

  # Number of authentication tries before locking an account if lock_strategy
  # is failed attempts.
  # config.maximum_attempts = 20

  # Time interval to unlock the account if :time is enabled as unlock_strategy.
  # config.unlock_in = 1.hour

  # Warn on the last attempt before the account is locked.
  # config.last_attempt_warning = true

  # ==> Configuration for :recoverable
  #
  # Defines which key will be used when recovering the password for an account
  # config.reset_password_keys = [:email]

  # Time interval you can reset your password with a reset password key.
  # Don't put a too small interval or your users won't have the time to
  # change their passwords.
  config.reset_password_within = 6.hours

  # When set to false, does not sign a user in automatically after their password is
  # reset. Defaults to true, so a user is signed in automatically after a reset.
  # config.sign_in_after_reset_password = true

  # ==> Configuration for :encryptable
  # Allow you to use another hashing or encryption algorithm besides bcrypt (default).
  # You can use :sha1, :sha512 or algorithms from others authentication tools as
  # :clearance_sha1, :authlogic_sha512 (then you should set stretches above to 20
  # for default behavior) and :restful_authentication_sha1 (then you should set
  # stretches to 10, and copy REST_AUTH_SITE_KEY to pepper).
  #
  # Require the `devise-encryptable` gem when using anything other than bcrypt
  # config.encryptor = :sha512

  # ==> Scopes configuration
  # Turn scoped views on. Before rendering "sessions/new", it will first check for
  # "users/sessions/new". It's turned off by default because it's slower if you
  # are using only default views.
  # config.scoped_views = false

  # Configure the default scope given to Warden. By default it's the first
  # devise role declared in your routes (usually :user).
  # config.default_scope = :user

  # Set this configuration to false if you want /users/sign_out to sign out
  # only the current scope. By default, Devise signs out all scopes.
  # config.sign_out_all_scopes = true

  # ==> Navigation configuration
  # Lists the formats that should be treated as navigational. Formats like
  # :html should redirect to the sign in page when the user does not have
  # access, but formats like :xml or :json, should return 401.
  #
  # If you have any extra navigational formats, like :iphone or :mobile, you
  # should add them to the navigational formats lists.
  #
  # The "*/*" below is required to match Internet Explorer requests.
  # config.navigational_formats = ['*/*', :html, :turbo_stream]

  # The default HTTP method used to sign out a resource. Default is :delete.
  config.sign_out_via = :delete

  # ==> OmniAuth
  # Add a new OmniAuth provider. Check the wiki for more information on setting
  # up on your models and hooks.
  # config.omniauth :github, 'APP_ID', 'APP_SECRET', scope: 'user,public_repo'

  # ==> Warden configuration
  # If you want to use other strategies, that are not supported by Devise, or
  # change the failure app, you can configure them inside the config.warden block.
  #
  # config.warden do |manager|
  #   manager.intercept_401 = false
  #   manager.default_strategies(scope: :user).unshift :some_external_strategy
  # end

  # ==> Mountable engine configurations
  # When using Devise inside an engine, let's call it `MyEngine`, and this engine
  # is mountable, there are some extra configurations to be taken into account.
  # The following options are available, assuming the engine is mounted as:
  #
  #     mount MyEngine, at: '/my_engine'
  #
  # The router that invoked `devise_for`, in the example above, would be:
  # config.router_name = :my_engine
  #
  # When using OmniAuth, Devise cannot automatically set OmniAuth path,
  # so you need to do it manually. For the users scope, it would be:
  # config.omniauth_path_prefix = '/my_engine/users/auth'

  # ==> Hotwire/Turbo configuration
  # When using Devise with Hotwire/Turbo, the http status for error responses
  # and some redirects must match the following. The default in Devise for existing
  # apps is `200 OK` and `302 Found` respectively, but new apps are generated with
  # these new defaults that match Hotwire/Turbo behavior.
  # Note: These might become the new default in future versions of Devise.
  config.responder.error_status = :unprocessable_entity
  config.responder.redirect_status = :see_other

  # ==> Configuration for :registerable

  # When set to false, does not sign a user in automatically after their password is
  # changed. Defaults to true, so a user is signed in automatically after changing a password.
  # config.sign_in_after_change_password = true
end

================
File: config/initializers/filter_parameter_logging.rb
================
# Be sure to restart your server when you modify this file.

# Configure parameters to be partially matched (e.g. passw matches password) and filtered from the log file.
# Use this to limit dissemination of sensitive information.
# See the ActiveSupport::ParameterFilter documentation for supported notations and behaviors.
Rails.application.config.filter_parameters += [
  :passw, :email, :secret, :token, :_key, :crypt, :salt, :certificate, :otp, :ssn
]

================
File: config/initializers/inflections.rb
================
# Be sure to restart your server when you modify this file.

# Add new inflection rules using the following format. Inflections
# are locale specific, and you may define rules for as many different
# locales as you wish. All of these examples are active by default:
# ActiveSupport::Inflector.inflections(:en) do |inflect|
#   inflect.plural /^(ox)$/i, "\\1en"
#   inflect.singular /^(ox)en/i, "\\1"
#   inflect.irregular "person", "people"
#   inflect.uncountable %w( fish sheep )
# end

# These inflection rules are supported but not enabled by default:
# ActiveSupport::Inflector.inflections(:en) do |inflect|
#   inflect.acronym "RESTful"
# end

================
File: config/initializers/openai.rb
================
require 'openai'

OpenAI.configure do |config|
  config.access_token = ENV['OPENAI_API_KEY']
end

================
File: config/initializers/permissions_policy.rb
================
# Be sure to restart your server when you modify this file.

# Define an application-wide HTTP permissions policy. For further
# information see: https://developers.google.com/web/updates/2018/06/feature-policy

# Rails.application.config.permissions_policy do |policy|
#   policy.camera      :none
#   policy.gyroscope   :none
#   policy.microphone  :none
#   policy.usb         :none
#   policy.fullscreen  :self
#   policy.payment     :self, "https://secure.example.com"
# end

================
File: config/initializers/sidekiq.rb
================
Sidekiq.configure_server do |config|
    config.redis = { url: 'redis://localhost:6379/0' }
  end
  
  Sidekiq.configure_client do |config|
    config.redis = { url: 'redis://localhost:6379/0' }
  end

================
File: config/locales/devise.en.yml
================
# Additional translations at https://github.com/heartcombo/devise/wiki/I18n

en:
  devise:
    confirmations:
      confirmed: "Your email address has been successfully confirmed."
      send_instructions: "You will receive an email with instructions for how to confirm your email address in a few minutes."
      send_paranoid_instructions: "If your email address exists in our database, you will receive an email with instructions for how to confirm your email address in a few minutes."
    failure:
      already_authenticated: "You are already signed in."
      inactive: "Your account is not activated yet."
      invalid: "Invalid %{authentication_keys} or password."
      locked: "Your account is locked."
      last_attempt: "You have one more attempt before your account is locked."
      not_found_in_database: "Invalid %{authentication_keys} or password."
      timeout: "Your session expired. Please sign in again to continue."
      unauthenticated: "You need to sign in or sign up before continuing."
      unconfirmed: "You have to confirm your email address before continuing."
    mailer:
      confirmation_instructions:
        subject: "Confirmation instructions"
      reset_password_instructions:
        subject: "Reset password instructions"
      unlock_instructions:
        subject: "Unlock instructions"
      email_changed:
        subject: "Email Changed"
      password_change:
        subject: "Password Changed"
    omniauth_callbacks:
      failure: "Could not authenticate you from %{kind} because \"%{reason}\"."
      success: "Successfully authenticated from %{kind} account."
    passwords:
      no_token: "You can't access this page without coming from a password reset email. If you do come from a password reset email, please make sure you used the full URL provided."
      send_instructions: "You will receive an email with instructions on how to reset your password in a few minutes."
      send_paranoid_instructions: "If your email address exists in our database, you will receive a password recovery link at your email address in a few minutes."
      updated: "Your password has been changed successfully. You are now signed in."
      updated_not_active: "Your password has been changed successfully."
    registrations:
      destroyed: "Bye! Your account has been successfully cancelled. We hope to see you again soon."
      signed_up: "Welcome! You have signed up successfully."
      signed_up_but_inactive: "You have signed up successfully. However, we could not sign you in because your account is not yet activated."
      signed_up_but_locked: "You have signed up successfully. However, we could not sign you in because your account is locked."
      signed_up_but_unconfirmed: "A message with a confirmation link has been sent to your email address. Please follow the link to activate your account."
      update_needs_confirmation: "You updated your account successfully, but we need to verify your new email address. Please check your email and follow the confirmation link to confirm your new email address."
      updated: "Your account has been updated successfully."
      updated_but_not_signed_in: "Your account has been updated successfully, but since your password was changed, you need to sign in again."
    sessions:
      signed_in: "Signed in successfully."
      signed_out: "Signed out successfully."
      already_signed_out: "Signed out successfully."
    unlocks:
      send_instructions: "You will receive an email with instructions for how to unlock your account in a few minutes."
      send_paranoid_instructions: "If your account exists, you will receive an email with instructions for how to unlock it in a few minutes."
      unlocked: "Your account has been unlocked successfully. Please sign in to continue."
  errors:
    messages:
      already_confirmed: "was already confirmed, please try signing in"
      confirmation_period_expired: "needs to be confirmed within %{period}, please request a new one"
      expired: "has expired, please request a new one"
      not_found: "not found"
      not_locked: "was not locked"
      not_saved:
        one: "1 error prohibited this %{resource} from being saved:"
        other: "%{count} errors prohibited this %{resource} from being saved:"

================
File: config/locales/en.yml
================
# Files in the config/locales directory are used for internationalization and
# are automatically loaded by Rails. If you want to use locales other than
# English, add the necessary files in this directory.
#
# To use the locales, use `I18n.t`:
#
#     I18n.t "hello"
#
# In views, this is aliased to just `t`:
#
#     <%= t("hello") %>
#
# To use a different locale, set it with `I18n.locale`:
#
#     I18n.locale = :es
#
# This would use the information in config/locales/es.yml.
#
# To learn more about the API, please read the Rails Internationalization guide
# at https://guides.rubyonrails.org/i18n.html.
#
# Be aware that YAML interprets the following case-insensitive strings as
# booleans: `true`, `false`, `on`, `off`, `yes`, `no`. Therefore, these strings
# must be quoted to be interpreted as strings. For example:
#
#     en:
#       "yes": yup
#       enabled: "ON"

en:
  hello: "Hello world"

================
File: config/puma.rb
================
# This configuration file will be evaluated by Puma. The top-level methods that
# are invoked here are part of Puma's configuration DSL. For more information
# about methods provided by the DSL, see https://puma.io/puma/Puma/DSL.html.

# Puma starts a configurable number of processes (workers) and each process
# serves each request in a thread from an internal thread pool.
#
# The ideal number of threads per worker depends both on how much time the
# application spends waiting for IO operations and on how much you wish to
# to prioritize throughput over latency.
#
# As a rule of thumb, increasing the number of threads will increase how much
# traffic a given process can handle (throughput), but due to CRuby's
# Global VM Lock (GVL) it has diminishing returns and will degrade the
# response time (latency) of the application.
#
# The default is set to 3 threads as it's deemed a decent compromise between
# throughput and latency for the average Rails application.
#
# Any libraries that use a connection pool or another resource pool should
# be configured to provide at least as many connections as the number of
# threads. This includes Active Record's `pool` parameter in `database.yml`.
threads_count = ENV.fetch("RAILS_MAX_THREADS", 3)
threads threads_count, threads_count

# Specifies the `port` that Puma will listen on to receive requests; default is 3000.
port ENV.fetch("PORT", 3000)

# Allow puma to be restarted by `bin/rails restart` command.
plugin :tmp_restart

# Specify the PID file. Defaults to tmp/pids/server.pid in development.
# In other environments, only set the PID file if requested.
pidfile ENV["PIDFILE"] if ENV["PIDFILE"]

================
File: config/routes.rb
================
Rails.application.routes.draw do
  get "prds/new"
  get "prds/create"
  get "prds/show"
  devise_for :users
  
  authenticated :user do
    root 'pages#dashboard', as: :authenticated_root
  end

  resources :product_ideas do
    resources :prds do
      member do
        get :generating
        get :check_status
      end
      resources :product_manager_copilot, only: [:show, :create, :update]
    end
  end


  
  root 'pages#home'
  get 'dashboard', to: 'pages#dashboard'
  
  resources :product_ideas
  get "product_ideas/index"
  get "product_ideas/show"
  get "product_ideas/new"
  get "product_ideas/create"
  get "product_ideas/edit"
  get "product_ideas/update"
  get "product_ideas/destroy"
end

================
File: config/sidekiq.yml
================
:concurrency: 5
:queues:
  - default
  - mailers

================
File: config/storage.yml
================
test:
  service: Disk
  root: <%= Rails.root.join("tmp/storage") %>

local:
  service: Disk
  root: <%= Rails.root.join("storage") %>

# Use bin/rails credentials:edit to set the AWS secrets (as aws:access_key_id|secret_access_key)
# amazon:
#   service: S3
#   access_key_id: <%= Rails.application.credentials.dig(:aws, :access_key_id) %>
#   secret_access_key: <%= Rails.application.credentials.dig(:aws, :secret_access_key) %>
#   region: us-east-1
#   bucket: your_own_bucket-<%= Rails.env %>

# Remember not to checkin your GCS keyfile to a repository
# google:
#   service: GCS
#   project: your_project
#   credentials: <%= Rails.root.join("path/to/gcs.keyfile") %>
#   bucket: your_own_bucket-<%= Rails.env %>

# Use bin/rails credentials:edit to set the Azure Storage secret (as azure_storage:storage_access_key)
# microsoft:
#   service: AzureStorage
#   storage_account_name: your_account_name
#   storage_access_key: <%= Rails.application.credentials.dig(:azure_storage, :storage_access_key) %>
#   container: your_container_name-<%= Rails.env %>

# mirror:
#   service: Mirror
#   primary: local
#   mirrors: [ amazon, google, microsoft ]

================
File: config/tailwind.config.js
================
const defaultTheme = require('tailwindcss/defaultTheme')

module.exports = {
  content: [
    './public/*.html',
    './app/helpers/**/*.rb',
    './app/javascript/**/*.js',
    './app/views/**/*.{erb,haml,html,slim}'
  ],
  theme: {
    extend: {
      fontFamily: {
        sans: ['Inter var', ...defaultTheme.fontFamily.sans],
      },
    },
  },
  plugins: [
    require('@tailwindcss/forms'),
    require('@tailwindcss/typography'),
    require('@tailwindcss/container-queries'),
  ]
}

================
File: db/migrate/20240914144559_create_product_ideas.rb
================
class CreateProductIdeas < ActiveRecord::Migration[7.2]
  def change
    create_table :product_ideas do |t|
      t.string :title
      t.text :description
      t.string :status

      t.timestamps
    end
  end
end

================
File: db/migrate/20240914200110_devise_create_users.rb
================
# frozen_string_literal: true

class DeviseCreateUsers < ActiveRecord::Migration[7.2]
  def change
    create_table :users do |t|
      ## Database authenticatable
      t.string :email,              null: false, default: ""
      t.string :encrypted_password, null: false, default: ""

      ## Recoverable
      t.string   :reset_password_token
      t.datetime :reset_password_sent_at

      ## Rememberable
      t.datetime :remember_created_at

      ## Trackable
      # t.integer  :sign_in_count, default: 0, null: false
      # t.datetime :current_sign_in_at
      # t.datetime :last_sign_in_at
      # t.string   :current_sign_in_ip
      # t.string   :last_sign_in_ip

      ## Confirmable
      # t.string   :confirmation_token
      # t.datetime :confirmed_at
      # t.datetime :confirmation_sent_at
      # t.string   :unconfirmed_email # Only if using reconfirmable

      ## Lockable
      # t.integer  :failed_attempts, default: 0, null: false # Only if lock strategy is :failed_attempts
      # t.string   :unlock_token # Only if unlock strategy is :email or :both
      # t.datetime :locked_at


      t.timestamps null: false
    end

    add_index :users, :email,                unique: true
    add_index :users, :reset_password_token, unique: true
    # add_index :users, :confirmation_token,   unique: true
    # add_index :users, :unlock_token,         unique: true
  end
end

================
File: db/migrate/20240915190419_add_user_to_product_ideas.rb
================
class AddUserToProductIdeas < ActiveRecord::Migration[7.0]
  def up
    add_reference :product_ideas, :user, null: true, foreign_key: true
    
    # If you have a default user or want to assign all existing product ideas to a specific user, 
    # you can uncomment and modify the following lines:
    # default_user = User.first
    # ProductIdea.update_all(user_id: default_user.id) if default_user

    # If you want to make the column non-nullable after assigning users, uncomment this line:
    # change_column_null :product_ideas, :user_id, false
  end

  def down
    remove_reference :product_ideas, :user
  end
end

================
File: db/migrate/20240915232910_create_prds.rb
================
class CreatePrds < ActiveRecord::Migration[7.2]
  def change
    create_table :prds do |t|
      t.string :title
      t.text :content
      t.references :product_idea, null: false, foreign_key: true

      t.timestamps
    end
  end
end

================
File: db/migrate/20240916203842_add_status_to_prds.rb
================
class AddStatusToPrds < ActiveRecord::Migration[7.2]
  def change
    add_column :prds, :status, :string
  end
end

================
File: db/migrate/20240917200038_add_prd_context_to_product_ideas.rb
================
# db/migrate/[timestamp]_add_prd_context_to_product_ideas.rb
class AddPrdContextToProductIdeas < ActiveRecord::Migration[7.2]
  def change
    add_column :product_ideas, :customer_acv, :decimal, precision: 10, scale: 2
    add_column :product_ideas, :customer_impact, :string
    add_column :product_ideas, :tshirt_size_effort, :string
  end
end

================
File: db/migrate/20241002232128_create_conversations.rb
================
class CreateConversations < ActiveRecord::Migration[7.2]
  def change
    create_table :conversations, id: :uuid do |t|
      t.references :prd, type: :uuid, foreign_key: true

      t.timestamps
    end
  end
end

================
File: db/migrate/20241002232134_create_messages.rb
================
class CreateMessages < ActiveRecord::Migration[7.2]
  def change
    create_table :messages, id: :uuid do |t|
      t.references :conversation, null: false, foreign_key: true, type: :uuid
      t.text :content
      t.string :role

      t.timestamps
    end
  end
end

================
File: db/migrate/20241002232541_update_prds_to_uuid.rb
================
# db/migrate/[TIMESTAMP]_update_prds_to_uuid.rb
class UpdatePrdsToUuid < ActiveRecord::Migration[7.2]
  def up
    # Check if the id column is already UUID
    return if id_is_uuid?(:prds)

    # Add a new uuid column
    add_column :prds, :uuid, :uuid, default: "gen_random_uuid()", null: false

    # Add a unique constraint to the new uuid column
    add_index :prds, :uuid, unique: true

    # Generate new UUIDs for existing records
    execute "UPDATE prds SET uuid = gen_random_uuid()"

    # If there are any foreign keys referencing prds, we need to update them
    update_foreign_keys

    # Remove the old id column
    remove_column :prds, :id

    # Rename uuid column to id
    rename_column :prds, :uuid, :id

    # Add primary key constraint to the id column
    execute "ALTER TABLE prds ADD PRIMARY KEY (id)"
  end

  def down
    raise ActiveRecord::IrreversibleMigration
  end

  private

  def id_is_uuid?(table_name)
    column_type = connection.columns(table_name).find { |c| c.name == 'id' }&.type
    column_type == :uuid
  end

  def update_foreign_keys
    # Get all tables that have a foreign key to prds
    fk_tables = foreign_keys(:prds).map(&:from_table).uniq

    fk_tables.each do |table|
      # Find the name of the column referencing prds
      fk = foreign_keys(table).find { |fk| fk.to_table == 'prds' }
      next unless fk

      fk_column = fk.column

      # Create a temporary column to store the new UUIDs
      add_column table, :temp_prd_uuid, :uuid

      # Update the temporary column with the new UUIDs from prds
      execute <<-SQL
        UPDATE #{table} 
        SET temp_prd_uuid = prds.uuid 
        FROM prds 
        WHERE #{table}.#{fk_column} = prds.id::text
      SQL

      # Remove the old foreign key constraint
      remove_foreign_key table, :prds

      # Remove the old column
      remove_column table, fk_column

      # Rename the temporary column
      rename_column table, :temp_prd_uuid, fk_column

      # Add the new foreign key constraint
      add_foreign_key table, :prds, column: fk_column, primary_key: 'uuid'
    end
  end
end

================
File: db/migrate/20241002233619_update_prds_id_to_uuid.rb
================
# db/migrate/[TIMESTAMP]_update_prds_id_to_uuid.rb
class UpdatePrdsIdToUuid < ActiveRecord::Migration[7.2]
  def up
    # Temporarily drop the foreign key if it exists
    if foreign_key_exists?(:product_ideas, :prds)
      remove_foreign_key :product_ideas, :prds
    end

    # Add a new uuid column
    add_column :prds, :uuid, :uuid, default: "gen_random_uuid()", null: false

    # Copy data from id to uuid
    Prd.all.each do |prd|
      prd.uuid = Prd.connection.execute("SELECT gen_random_uuid()").first["gen_random_uuid"]
      prd.save!
    end

    # Remove the primary key
    execute "ALTER TABLE prds DROP CONSTRAINT prds_pkey;"

    # Remove the old id column
    remove_column :prds, :id

    # Rename uuid column to id
    rename_column :prds, :uuid, :id

    # Add primary key constraint
    execute "ALTER TABLE prds ADD PRIMARY KEY (id);"

    # Update the product_ideas foreign key
    if column_exists?(:product_ideas, :prd_id)
      add_column :product_ideas, :prd_uuid, :uuid
      ProductIdea.all.each do |pi|
        pi.prd_uuid = Prd.find_by(id: pi.prd_id)&.id
        pi.save!
      end
      remove_column :product_ideas, :prd_id
      rename_column :product_ideas, :prd_uuid, :prd_id
      add_foreign_key :product_ideas, :prds
    end
  end

  def down
    raise ActiveRecord::IrreversibleMigration
  end
end

================
File: db/migrate/20241002233844_convert_prds_to_uuid.rb
================
# db/migrate/[TIMESTAMP]_convert_prds_to_uuid.rb
class ConvertPrdsToUuid < ActiveRecord::Migration[7.2]
  def up
    # Add a new uuid column to prds
    add_column :prds, :uuid, :uuid, default: "gen_random_uuid()", null: false

    # Add a new uuid column to product_ideas
    add_column :product_ideas, :uuid, :uuid, default: "gen_random_uuid()", null: false

    # Remove the foreign key constraint
    remove_foreign_key :prds, :product_ideas

    # Update the uuid values
    execute <<-SQL
      UPDATE prds SET uuid = gen_random_uuid();
      UPDATE product_ideas SET uuid = gen_random_uuid();
    SQL

    # Add a new column for the foreign key relationship
    add_column :prds, :product_idea_uuid, :uuid

    # Update the new foreign key column
    execute <<-SQL
      UPDATE prds
      SET product_idea_uuid = product_ideas.uuid
      FROM product_ideas
      WHERE prds.product_idea_id = product_ideas.id;
    SQL

    # Remove old id and foreign key columns
    remove_column :prds, :id
    remove_column :prds, :product_idea_id
    remove_column :product_ideas, :id

    # Rename uuid columns to id
    rename_column :prds, :uuid, :id
    rename_column :product_ideas, :uuid, :id
    rename_column :prds, :product_idea_uuid, :product_idea_id

    # Add primary key constraints
    execute "ALTER TABLE prds ADD PRIMARY KEY (id);"
    execute "ALTER TABLE product_ideas ADD PRIMARY KEY (id);"

    # Add the new foreign key constraint
    add_foreign_key :prds, :product_ideas

    # Update sequences if any
    execute "DROP SEQUENCE IF EXISTS prds_id_seq;"
    execute "DROP SEQUENCE IF EXISTS product_ideas_id_seq;"
  end

  def down
    raise ActiveRecord::IrreversibleMigration
  end
end

================
File: db/schema.rb
================
# This file is auto-generated from the current state of the database. Instead
# of editing this file, please use the migrations feature of Active Record to
# incrementally modify your database, and then regenerate this schema definition.
#
# This file is the source Rails uses to define your schema when running `bin/rails
# db:schema:load`. When creating a new database, `bin/rails db:schema:load` tends to
# be faster and is potentially less error prone than running all of your
# migrations from scratch. Old migrations may fail to apply correctly if those
# migrations use external dependencies or application code.
#
# It's strongly recommended that you check this file into your version control system.

ActiveRecord::Schema[7.2].define(version: 2024_10_02_233844) do
  # These are extensions that must be enabled in order to support this database
  enable_extension "plpgsql"

  create_table "conversations", id: :uuid, default: -> { "gen_random_uuid()" }, force: :cascade do |t|
    t.uuid "prd_id"
    t.datetime "created_at", null: false
    t.datetime "updated_at", null: false
    t.index ["prd_id"], name: "index_conversations_on_prd_id"
  end

  create_table "messages", id: :uuid, default: -> { "gen_random_uuid()" }, force: :cascade do |t|
    t.uuid "conversation_id", null: false
    t.text "content"
    t.string "role"
    t.datetime "created_at", null: false
    t.datetime "updated_at", null: false
    t.index ["conversation_id"], name: "index_messages_on_conversation_id"
  end

  create_table "prds", id: :uuid, default: -> { "gen_random_uuid()" }, force: :cascade do |t|
    t.string "title"
    t.text "content"
    t.datetime "created_at", null: false
    t.datetime "updated_at", null: false
    t.string "status"
    t.uuid "product_idea_id"
  end

  create_table "product_ideas", id: :uuid, default: -> { "gen_random_uuid()" }, force: :cascade do |t|
    t.string "title"
    t.text "description"
    t.string "status"
    t.datetime "created_at", null: false
    t.datetime "updated_at", null: false
    t.bigint "user_id"
    t.decimal "customer_acv", precision: 10, scale: 2
    t.string "customer_impact"
    t.string "tshirt_size_effort"
    t.index ["user_id"], name: "index_product_ideas_on_user_id"
  end

  create_table "users", force: :cascade do |t|
    t.string "email", default: "", null: false
    t.string "encrypted_password", default: "", null: false
    t.string "reset_password_token"
    t.datetime "reset_password_sent_at"
    t.datetime "remember_created_at"
    t.datetime "created_at", null: false
    t.datetime "updated_at", null: false
    t.index ["email"], name: "index_users_on_email", unique: true
    t.index ["reset_password_token"], name: "index_users_on_reset_password_token", unique: true
  end

  add_foreign_key "conversations", "prds"
  add_foreign_key "messages", "conversations"
  add_foreign_key "prds", "product_ideas"
  add_foreign_key "product_ideas", "users"
end

================
File: db/seeds.rb
================
# This file should ensure the existence of records required to run the application in every environment (production,
# development, test). The code here should be idempotent so that it can be executed at any point in every environment.
# The data can then be loaded with the bin/rails db:seed command (or created alongside the database with db:setup).
#
# Example:
#
#   ["Action", "Comedy", "Drama", "Horror"].each do |genre_name|
#     MovieGenre.find_or_create_by!(name: genre_name)
#   end

================
File: Dockerfile
================
# syntax = docker/dockerfile:1

# This Dockerfile is designed for production, not development. Use with Kamal or build'n'run by hand:
# docker build -t my-app .
# docker run -d -p 80:80 -p 443:443 --name my-app -e RAILS_MASTER_KEY=<value from config/master.key> my-app

# Make sure RUBY_VERSION matches the Ruby version in .ruby-version
ARG RUBY_VERSION=3.3.5
FROM docker.io/library/ruby:$RUBY_VERSION-slim AS base

# Rails app lives here
WORKDIR /rails

# Install base packages
RUN apt-get update -qq && \
    apt-get install --no-install-recommends -y curl libjemalloc2 libvips postgresql-client && \
    rm -rf /var/lib/apt/lists /var/cache/apt/archives

# Set production environment
ENV RAILS_ENV="production" \
    BUNDLE_DEPLOYMENT="1" \
    BUNDLE_PATH="/usr/local/bundle" \
    BUNDLE_WITHOUT="development"

# Throw-away build stage to reduce size of final image
FROM base AS build

# Install packages needed to build gems
RUN apt-get update -qq && \
    apt-get install --no-install-recommends -y build-essential git libpq-dev pkg-config && \
    rm -rf /var/lib/apt/lists /var/cache/apt/archives

# Install application gems
COPY Gemfile Gemfile.lock ./
RUN bundle install && \
    rm -rf ~/.bundle/ "${BUNDLE_PATH}"/ruby/*/cache "${BUNDLE_PATH}"/ruby/*/bundler/gems/*/.git && \
    bundle exec bootsnap precompile --gemfile

# Copy application code
COPY . .

# Precompile bootsnap code for faster boot times
RUN bundle exec bootsnap precompile app/ lib/

# Adjust binfiles to be executable on Linux
RUN chmod +x bin/* && \
    sed -i "s/\r$//g" bin/* && \
    sed -i 's/ruby\.exe$/ruby/' bin/*

# Precompiling assets for production without requiring secret RAILS_MASTER_KEY
RUN SECRET_KEY_BASE_DUMMY=1 ./bin/rails assets:precompile




# Final stage for app image
FROM base

# Copy built artifacts: gems, application
COPY --from=build "${BUNDLE_PATH}" "${BUNDLE_PATH}"
COPY --from=build /rails /rails

# Run and own only the runtime files as a non-root user for security
RUN groupadd --system --gid 1000 rails && \
    useradd rails --uid 1000 --gid 1000 --create-home --shell /bin/bash && \
    chown -R rails:rails db log storage tmp
USER 1000:1000

# Entrypoint prepares the database.
ENTRYPOINT ["/rails/bin/docker-entrypoint"]

# Start the server by default, this can be overwritten at runtime
EXPOSE 3000
CMD ["./bin/rails", "server"]

================
File: Gemfile
================
source "https://rubygems.org"

# Bundle edge Rails instead: gem "rails", github: "rails/rails", branch: "main"
gem "rails", "~> 7.2.1"
# The original asset pipeline for Rails [https://github.com/rails/sprockets-rails]
gem "sprockets-rails"
# Use postgresql as the database for Active Record
gem "pg", "~> 1.1"
# Use the Puma web server [https://github.com/puma/puma]
gem "puma", ">= 5.0"
# Use JavaScript with ESM import maps [https://github.com/rails/importmap-rails]
gem "importmap-rails"
# Hotwire's SPA-like page accelerator [https://turbo.hotwired.dev]
gem "turbo-rails"
# Hotwire's modest JavaScript framework [https://stimulus.hotwired.dev]
gem "stimulus-rails"
# Build JSON APIs with ease [https://github.com/rails/jbuilder]
gem "jbuilder"
# Use Redis adapter to run Action Cable in production
# gem "redis", ">= 4.0.1"



#using devise for authentication
gem 'devise'

#for AI features
gem 'ruby-openai'

#for loading jobs and state
gem 'sidekiq'
gem 'redis', '~> 4.8'


#to help with ostruct warning
gem 'ostruct'

#to help with the secret key for OpenAI key
gem 'dotenv-rails', groups: [:development, :test]

# Use Kredis to get higher-level data types in Redis [https://github.com/rails/kredis]
# gem "kredis"

# Use Active Model has_secure_password [https://guides.rubyonrails.org/active_model_basics.html#securepassword]
# gem "bcrypt", "~> 3.1.7"

# Windows does not include zoneinfo files, so bundle the tzinfo-data gem
gem "tzinfo-data", platforms: %i[ windows jruby ]

#for the UI
#gem 'webpacker', '~> 5.0'
gem 'tailwindcss-rails'

# Reduces boot times through caching; required in config/boot.rb
gem "bootsnap", require: false

# Use Active Storage variants [https://guides.rubyonrails.org/active_storage_overview.html#transforming-images]
# gem "image_processing", "~> 1.2"

group :development, :test do
  # See https://guides.rubyonrails.org/debugging_rails_applications.html#debugging-with-the-debug-gem
  gem "debug", platforms: %i[ mri windows ], require: "debug/prelude"

  # Static analysis for security vulnerabilities [https://brakemanscanner.org/]
  gem "brakeman", require: false

  # Omakase Ruby styling [https://github.com/rails/rubocop-rails-omakase/]
  gem "rubocop-rails-omakase", require: false
end

group :development do
  # Use console on exceptions pages [https://github.com/rails/web-console]
  gem "web-console"
end

group :test do
  # Use system testing [https://guides.rubyonrails.org/testing.html#system-testing]
  gem "capybara"
  gem "selenium-webdriver"
end

================
File: Gemfile.lock
================
GEM
  remote: https://rubygems.org/
  specs:
    actioncable (7.2.1)
      actionpack (= 7.2.1)
      activesupport (= 7.2.1)
      nio4r (~> 2.0)
      websocket-driver (>= 0.6.1)
      zeitwerk (~> 2.6)
    actionmailbox (7.2.1)
      actionpack (= 7.2.1)
      activejob (= 7.2.1)
      activerecord (= 7.2.1)
      activestorage (= 7.2.1)
      activesupport (= 7.2.1)
      mail (>= 2.8.0)
    actionmailer (7.2.1)
      actionpack (= 7.2.1)
      actionview (= 7.2.1)
      activejob (= 7.2.1)
      activesupport (= 7.2.1)
      mail (>= 2.8.0)
      rails-dom-testing (~> 2.2)
    actionpack (7.2.1)
      actionview (= 7.2.1)
      activesupport (= 7.2.1)
      nokogiri (>= 1.8.5)
      racc
      rack (>= 2.2.4, < 3.2)
      rack-session (>= 1.0.1)
      rack-test (>= 0.6.3)
      rails-dom-testing (~> 2.2)
      rails-html-sanitizer (~> 1.6)
      useragent (~> 0.16)
    actiontext (7.2.1)
      actionpack (= 7.2.1)
      activerecord (= 7.2.1)
      activestorage (= 7.2.1)
      activesupport (= 7.2.1)
      globalid (>= 0.6.0)
      nokogiri (>= 1.8.5)
    actionview (7.2.1)
      activesupport (= 7.2.1)
      builder (~> 3.1)
      erubi (~> 1.11)
      rails-dom-testing (~> 2.2)
      rails-html-sanitizer (~> 1.6)
    activejob (7.2.1)
      activesupport (= 7.2.1)
      globalid (>= 0.3.6)
    activemodel (7.2.1)
      activesupport (= 7.2.1)
    activerecord (7.2.1)
      activemodel (= 7.2.1)
      activesupport (= 7.2.1)
      timeout (>= 0.4.0)
    activestorage (7.2.1)
      actionpack (= 7.2.1)
      activejob (= 7.2.1)
      activerecord (= 7.2.1)
      activesupport (= 7.2.1)
      marcel (~> 1.0)
    activesupport (7.2.1)
      base64
      bigdecimal
      concurrent-ruby (~> 1.0, >= 1.3.1)
      connection_pool (>= 2.2.5)
      drb
      i18n (>= 1.6, < 2)
      logger (>= 1.4.2)
      minitest (>= 5.1)
      securerandom (>= 0.3)
      tzinfo (~> 2.0, >= 2.0.5)
    addressable (2.8.7)
      public_suffix (>= 2.0.2, < 7.0)
    ast (2.4.2)
    base64 (0.2.0)
    bcrypt (3.1.20)
    bigdecimal (3.1.8)
    bindex (0.8.1)
    bootsnap (1.18.4)
      msgpack (~> 1.2)
    brakeman (6.2.1)
      racc
    builder (3.3.0)
    capybara (3.40.0)
      addressable
      matrix
      mini_mime (>= 0.1.3)
      nokogiri (~> 1.11)
      rack (>= 1.6.0)
      rack-test (>= 0.6.3)
      regexp_parser (>= 1.5, < 3.0)
      xpath (~> 3.2)
    concurrent-ruby (1.3.4)
    connection_pool (2.4.1)
    crass (1.0.6)
    date (3.3.4)
    debug (1.9.2)
      irb (~> 1.10)
      reline (>= 0.3.8)
    devise (4.9.4)
      bcrypt (~> 3.0)
      orm_adapter (~> 0.1)
      railties (>= 4.1.0)
      responders
      warden (~> 1.2.3)
    dotenv (3.1.2)
    dotenv-rails (3.1.2)
      dotenv (= 3.1.2)
      railties (>= 6.1)
    drb (2.2.1)
    erubi (1.13.0)
    event_stream_parser (1.0.0)
    faraday (2.11.0)
      faraday-net_http (>= 2.0, < 3.4)
      logger
    faraday-multipart (1.0.4)
      multipart-post (~> 2)
    faraday-net_http (3.3.0)
      net-http
    globalid (1.2.1)
      activesupport (>= 6.1)
    i18n (1.14.5)
      concurrent-ruby (~> 1.0)
    importmap-rails (2.0.1)
      actionpack (>= 6.0.0)
      activesupport (>= 6.0.0)
      railties (>= 6.0.0)
    io-console (0.7.2)
    irb (1.14.0)
      rdoc (>= 4.0.0)
      reline (>= 0.4.2)
    jbuilder (2.12.0)
      actionview (>= 5.0.0)
      activesupport (>= 5.0.0)
    json (2.7.2)
    language_server-protocol (3.17.0.3)
    logger (1.6.1)
    loofah (2.22.0)
      crass (~> 1.0.2)
      nokogiri (>= 1.12.0)
    mail (2.8.1)
      mini_mime (>= 0.1.1)
      net-imap
      net-pop
      net-smtp
    marcel (1.0.4)
    matrix (0.4.2)
    mini_mime (1.1.5)
    minitest (5.25.1)
    msgpack (1.7.2)
    multipart-post (2.4.1)
    net-http (0.4.1)
      uri
    net-imap (0.4.16)
      date
      net-protocol
    net-pop (0.1.2)
      net-protocol
    net-protocol (0.2.2)
      timeout
    net-smtp (0.5.0)
      net-protocol
    nio4r (2.7.3)
    nokogiri (1.16.7-x64-mingw-ucrt)
      racc (~> 1.4)
    nokogiri (1.16.7-x86_64-linux)
      racc (~> 1.4)
    orm_adapter (0.5.0)
    ostruct (0.6.0)
    parallel (1.26.3)
    parser (3.3.5.0)
      ast (~> 2.4.1)
      racc
    pg (1.5.8)
    pg (1.5.8-x64-mingw-ucrt)
    psych (5.1.2)
      stringio
    public_suffix (6.0.1)
    puma (6.4.2)
      nio4r (~> 2.0)
    racc (1.8.1)
    rack (3.1.7)
    rack-session (2.0.0)
      rack (>= 3.0.0)
    rack-test (2.1.0)
      rack (>= 1.3)
    rackup (2.1.0)
      rack (>= 3)
      webrick (~> 1.8)
    rails (7.2.1)
      actioncable (= 7.2.1)
      actionmailbox (= 7.2.1)
      actionmailer (= 7.2.1)
      actionpack (= 7.2.1)
      actiontext (= 7.2.1)
      actionview (= 7.2.1)
      activejob (= 7.2.1)
      activemodel (= 7.2.1)
      activerecord (= 7.2.1)
      activestorage (= 7.2.1)
      activesupport (= 7.2.1)
      bundler (>= 1.15.0)
      railties (= 7.2.1)
    rails-dom-testing (2.2.0)
      activesupport (>= 5.0.0)
      minitest
      nokogiri (>= 1.6)
    rails-html-sanitizer (1.6.0)
      loofah (~> 2.21)
      nokogiri (~> 1.14)
    railties (7.2.1)
      actionpack (= 7.2.1)
      activesupport (= 7.2.1)
      irb (~> 1.13)
      rackup (>= 1.0.0)
      rake (>= 12.2)
      thor (~> 1.0, >= 1.2.2)
      zeitwerk (~> 2.6)
    rainbow (3.1.1)
    rake (13.2.1)
    rdoc (6.7.0)
      psych (>= 4.0.0)
    redis (4.8.1)
    redis-client (0.22.2)
      connection_pool
    regexp_parser (2.9.2)
    reline (0.5.10)
      io-console (~> 0.5)
    responders (3.1.1)
      actionpack (>= 5.2)
      railties (>= 5.2)
    rexml (3.3.7)
    rubocop (1.66.1)
      json (~> 2.3)
      language_server-protocol (>= 3.17.0)
      parallel (~> 1.10)
      parser (>= 3.3.0.2)
      rainbow (>= 2.2.2, < 4.0)
      regexp_parser (>= 2.4, < 3.0)
      rubocop-ast (>= 1.32.2, < 2.0)
      ruby-progressbar (~> 1.7)
      unicode-display_width (>= 2.4.0, < 3.0)
    rubocop-ast (1.32.3)
      parser (>= 3.3.1.0)
    rubocop-minitest (0.36.0)
      rubocop (>= 1.61, < 2.0)
      rubocop-ast (>= 1.31.1, < 2.0)
    rubocop-performance (1.21.1)
      rubocop (>= 1.48.1, < 2.0)
      rubocop-ast (>= 1.31.1, < 2.0)
    rubocop-rails (2.26.1)
      activesupport (>= 4.2.0)
      rack (>= 1.1)
      rubocop (>= 1.52.0, < 2.0)
      rubocop-ast (>= 1.31.1, < 2.0)
    rubocop-rails-omakase (1.0.0)
      rubocop
      rubocop-minitest
      rubocop-performance
      rubocop-rails
    ruby-openai (7.1.0)
      event_stream_parser (>= 0.3.0, < 2.0.0)
      faraday (>= 1)
      faraday-multipart (>= 1)
    ruby-progressbar (1.13.0)
    rubyzip (2.3.2)
    securerandom (0.3.1)
    selenium-webdriver (4.24.0)
      base64 (~> 0.2)
      logger (~> 1.4)
      rexml (~> 3.2, >= 3.2.5)
      rubyzip (>= 1.2.2, < 3.0)
      websocket (~> 1.0)
    sidekiq (7.3.2)
      concurrent-ruby (< 2)
      connection_pool (>= 2.3.0)
      logger
      rack (>= 2.2.4)
      redis-client (>= 0.22.2)
    sprockets (4.2.1)
      concurrent-ruby (~> 1.0)
      rack (>= 2.2.4, < 4)
    sprockets-rails (3.5.2)
      actionpack (>= 6.1)
      activesupport (>= 6.1)
      sprockets (>= 3.0.0)
    stimulus-rails (1.3.4)
      railties (>= 6.0.0)
    stringio (3.1.1)
    tailwindcss-rails (2.7.4-x64-mingw-ucrt)
      railties (>= 7.0.0)
    tailwindcss-rails (2.7.4-x86_64-linux)
      railties (>= 7.0.0)
    thor (1.3.2)
    timeout (0.4.1)
    turbo-rails (2.0.7)
      actionpack (>= 6.0.0)
      activejob (>= 6.0.0)
      railties (>= 6.0.0)
    tzinfo (2.0.6)
      concurrent-ruby (~> 1.0)
    tzinfo-data (1.2024.2)
      tzinfo (>= 1.0.0)
    unicode-display_width (2.6.0)
    uri (0.13.1)
    useragent (0.16.10)
    warden (1.2.9)
      rack (>= 2.0.9)
    web-console (4.2.1)
      actionview (>= 6.0.0)
      activemodel (>= 6.0.0)
      bindex (>= 0.4.0)
      railties (>= 6.0.0)
    webrick (1.8.1)
    websocket (1.2.11)
    websocket-driver (0.7.6)
      websocket-extensions (>= 0.1.0)
    websocket-extensions (0.1.5)
    xpath (3.2.0)
      nokogiri (~> 1.8)
    zeitwerk (2.6.18)

PLATFORMS
  x64-mingw-ucrt
  x86_64-linux

DEPENDENCIES
  bootsnap
  brakeman
  capybara
  debug
  devise
  dotenv-rails
  importmap-rails
  jbuilder
  ostruct
  pg (~> 1.1)
  puma (>= 5.0)
  rails (~> 7.2.1)
  redis (~> 4.8)
  rubocop-rails-omakase
  ruby-openai
  selenium-webdriver
  sidekiq
  sprockets-rails
  stimulus-rails
  tailwindcss-rails
  turbo-rails
  tzinfo-data
  web-console

BUNDLED WITH
   2.5.16

================
File: package.json
================
{
  "dependencies": {
    "autoprefixer": "^10.4.20",
    "postcss": "^8.4.47",
    "tailwindcss": "^3.4.11"
  }
}

================
File: Procfile.dev
================
web: bin/rails server
css: bin/rails tailwindcss:watch

================
File: public/404.html
================
<!DOCTYPE html>
<html>
<head>
  <title>The page you were looking for doesn't exist (404)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
  .rails-default-error-page {
    background-color: #EFEFEF;
    color: #2E2F30;
    text-align: center;
    font-family: arial, sans-serif;
    margin: 0;
  }

  .rails-default-error-page div.dialog {
    width: 95%;
    max-width: 33em;
    margin: 4em auto 0;
  }

  .rails-default-error-page div.dialog > div {
    border: 1px solid #CCC;
    border-right-color: #999;
    border-left-color: #999;
    border-bottom-color: #BBB;
    border-top: #B00100 solid 4px;
    border-top-left-radius: 9px;
    border-top-right-radius: 9px;
    background-color: white;
    padding: 7px 12% 0;
    box-shadow: 0 3px 8px rgba(50, 50, 50, 0.17);
  }

  .rails-default-error-page h1 {
    font-size: 100%;
    color: #730E15;
    line-height: 1.5em;
  }

  .rails-default-error-page div.dialog > p {
    margin: 0 0 1em;
    padding: 1em;
    background-color: #F7F7F7;
    border: 1px solid #CCC;
    border-right-color: #999;
    border-left-color: #999;
    border-bottom-color: #999;
    border-bottom-left-radius: 4px;
    border-bottom-right-radius: 4px;
    border-top-color: #DADADA;
    color: #666;
    box-shadow: 0 3px 8px rgba(50, 50, 50, 0.17);
  }
  </style>
</head>

<body class="rails-default-error-page">
  <!-- This file lives in public/404.html -->
  <div class="dialog">
    <div>
      <h1>The page you were looking for doesn't exist.</h1>
      <p>You may have mistyped the address or the page may have moved.</p>
    </div>
    <p>If you are the application owner check the logs for more information.</p>
  </div>
</body>
</html>

================
File: public/406-unsupported-browser.html
================
<!DOCTYPE html>
<html>
<head>
  <title>Your browser is not supported (406)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
  .rails-default-error-page {
    background-color: #EFEFEF;
    color: #2E2F30;
    text-align: center;
    font-family: arial, sans-serif;
    margin: 0;
  }

  .rails-default-error-page div.dialog {
    width: 95%;
    max-width: 33em;
    margin: 4em auto 0;
  }

  .rails-default-error-page div.dialog > div {
    border: 1px solid #CCC;
    border-right-color: #999;
    border-left-color: #999;
    border-bottom-color: #BBB;
    border-top: #B00100 solid 4px;
    border-top-left-radius: 9px;
    border-top-right-radius: 9px;
    background-color: white;
    padding: 7px 12% 0;
    box-shadow: 0 3px 8px rgba(50, 50, 50, 0.17);
  }

  .rails-default-error-page h1 {
    font-size: 100%;
    color: #730E15;
    line-height: 1.5em;
  }

  .rails-default-error-page div.dialog > p {
    margin: 0 0 1em;
    padding: 1em;
    background-color: #F7F7F7;
    border: 1px solid #CCC;
    border-right-color: #999;
    border-left-color: #999;
    border-bottom-color: #999;
    border-bottom-left-radius: 4px;
    border-bottom-right-radius: 4px;
    border-top-color: #DADADA;
    color: #666;
    box-shadow: 0 3px 8px rgba(50, 50, 50, 0.17);
  }
  </style>
</head>

<body class="rails-default-error-page">
  <!-- This file lives in public/406-unsupported-browser.html -->
  <div class="dialog">
    <div>
      <h1>Your browser is not supported.</h1>
      <p>Please upgrade your browser to continue.</p>
    </div>
  </div>
</body>
</html>

================
File: public/422.html
================
<!DOCTYPE html>
<html>
<head>
  <title>The change you wanted was rejected (422)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
  .rails-default-error-page {
    background-color: #EFEFEF;
    color: #2E2F30;
    text-align: center;
    font-family: arial, sans-serif;
    margin: 0;
  }

  .rails-default-error-page div.dialog {
    width: 95%;
    max-width: 33em;
    margin: 4em auto 0;
  }

  .rails-default-error-page div.dialog > div {
    border: 1px solid #CCC;
    border-right-color: #999;
    border-left-color: #999;
    border-bottom-color: #BBB;
    border-top: #B00100 solid 4px;
    border-top-left-radius: 9px;
    border-top-right-radius: 9px;
    background-color: white;
    padding: 7px 12% 0;
    box-shadow: 0 3px 8px rgba(50, 50, 50, 0.17);
  }

  .rails-default-error-page h1 {
    font-size: 100%;
    color: #730E15;
    line-height: 1.5em;
  }

  .rails-default-error-page div.dialog > p {
    margin: 0 0 1em;
    padding: 1em;
    background-color: #F7F7F7;
    border: 1px solid #CCC;
    border-right-color: #999;
    border-left-color: #999;
    border-bottom-color: #999;
    border-bottom-left-radius: 4px;
    border-bottom-right-radius: 4px;
    border-top-color: #DADADA;
    color: #666;
    box-shadow: 0 3px 8px rgba(50, 50, 50, 0.17);
  }
  </style>
</head>

<body class="rails-default-error-page">
  <!-- This file lives in public/422.html -->
  <div class="dialog">
    <div>
      <h1>The change you wanted was rejected.</h1>
      <p>Maybe you tried to change something you didn't have access to.</p>
    </div>
    <p>If you are the application owner check the logs for more information.</p>
  </div>
</body>
</html>

================
File: public/500.html
================
<!DOCTYPE html>
<html>
<head>
  <title>We're sorry, but something went wrong (500)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
  .rails-default-error-page {
    background-color: #EFEFEF;
    color: #2E2F30;
    text-align: center;
    font-family: arial, sans-serif;
    margin: 0;
  }

  .rails-default-error-page div.dialog {
    width: 95%;
    max-width: 33em;
    margin: 4em auto 0;
  }

  .rails-default-error-page div.dialog > div {
    border: 1px solid #CCC;
    border-right-color: #999;
    border-left-color: #999;
    border-bottom-color: #BBB;
    border-top: #B00100 solid 4px;
    border-top-left-radius: 9px;
    border-top-right-radius: 9px;
    background-color: white;
    padding: 7px 12% 0;
    box-shadow: 0 3px 8px rgba(50, 50, 50, 0.17);
  }

  .rails-default-error-page h1 {
    font-size: 100%;
    color: #730E15;
    line-height: 1.5em;
  }

  .rails-default-error-page div.dialog > p {
    margin: 0 0 1em;
    padding: 1em;
    background-color: #F7F7F7;
    border: 1px solid #CCC;
    border-right-color: #999;
    border-left-color: #999;
    border-bottom-color: #999;
    border-bottom-left-radius: 4px;
    border-bottom-right-radius: 4px;
    border-top-color: #DADADA;
    color: #666;
    box-shadow: 0 3px 8px rgba(50, 50, 50, 0.17);
  }
  </style>
</head>

<body class="rails-default-error-page">
  <!-- This file lives in public/500.html -->
  <div class="dialog">
    <div>
      <h1>We're sorry, but something went wrong.</h1>
    </div>
    <p>If you are the application owner check the logs for more information.</p>
  </div>
</body>
</html>

================
File: public/icon.svg
================
<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg">
  <rect width="100%" height="100%" fill="red"/>
</svg>

================
File: public/robots.txt
================
# See https://www.robotstxt.org/robotstxt.html for documentation on how to use the robots.txt file

================
File: Rakefile
================
# Add your own tasks in files placed in lib/tasks ending in .rake,
# for example lib/tasks/capistrano.rake, and they will automatically be available to Rake.

require_relative "config/application"

Rails.application.load_tasks

================
File: README.md
================
# README

This README would normally document whatever steps are necessary to get the
application up and running.

Things you may want to cover:

* Ruby version

* System dependencies

* Configuration

* Database creation

* Database initialization

* How to run the test suite

* Services (job queues, cache servers, search engines, etc.)

* Deployment instructions

* ...

================
File: test/application_system_test_case.rb
================
require "test_helper"

class ApplicationSystemTestCase < ActionDispatch::SystemTestCase
  driven_by :selenium, using: :headless_chrome, screen_size: [ 1400, 1400 ]
end

================
File: test/channels/application_cable/connection_test.rb
================
require "test_helper"

module ApplicationCable
  class ConnectionTest < ActionCable::Connection::TestCase
    # test "connects with cookies" do
    #   cookies.signed[:user_id] = 42
    #
    #   connect
    #
    #   assert_equal connection.user_id, "42"
    # end
  end
end

================
File: test/controllers/pages_controller_test.rb
================
require "test_helper"

class PagesControllerTest < ActionDispatch::IntegrationTest
  test "should get home" do
    get pages_home_url
    assert_response :success
  end
end

================
File: test/controllers/prds_controller_test.rb
================
require "test_helper"

class PrdsControllerTest < ActionDispatch::IntegrationTest
  test "should get new" do
    get prds_new_url
    assert_response :success
  end

  test "should get create" do
    get prds_create_url
    assert_response :success
  end

  test "should get show" do
    get prds_show_url
    assert_response :success
  end
end

================
File: test/controllers/product_ideas_controller_test.rb
================
require "test_helper"

class ProductIdeasControllerTest < ActionDispatch::IntegrationTest
  test "should get index" do
    get product_ideas_index_url
    assert_response :success
  end

  test "should get show" do
    get product_ideas_show_url
    assert_response :success
  end

  test "should get new" do
    get product_ideas_new_url
    assert_response :success
  end

  test "should get create" do
    get product_ideas_create_url
    assert_response :success
  end

  test "should get edit" do
    get product_ideas_edit_url
    assert_response :success
  end

  test "should get update" do
    get product_ideas_update_url
    assert_response :success
  end

  test "should get destroy" do
    get product_ideas_destroy_url
    assert_response :success
  end
end

================
File: test/fixtures/prds.yml
================
# Read about fixtures at https://api.rubyonrails.org/classes/ActiveRecord/FixtureSet.html

one:
  title: MyString
  content: MyText
  product_idea: one

two:
  title: MyString
  content: MyText
  product_idea: two

================
File: test/fixtures/product_ideas.yml
================
# Read about fixtures at https://api.rubyonrails.org/classes/ActiveRecord/FixtureSet.html

one:
  title: MyString
  description: MyText
  status: MyString

two:
  title: MyString
  description: MyText
  status: MyString

================
File: test/fixtures/users.yml
================
# Read about fixtures at https://api.rubyonrails.org/classes/ActiveRecord/FixtureSet.html

# This model initially had no columns defined. If you add columns to the
# model remove the "{}" from the fixture names and add the columns immediately
# below each fixture, per the syntax in the comments below
#
one: {}
# column: value
#
two: {}
# column: value

================
File: test/models/prd_test.rb
================
require "test_helper"

class PrdTest < ActiveSupport::TestCase
  # test "the truth" do
  #   assert true
  # end
end

================
File: test/models/product_idea_test.rb
================
require "test_helper"

class ProductIdeaTest < ActiveSupport::TestCase
  # test "the truth" do
  #   assert true
  # end
end

================
File: test/models/user_test.rb
================
require "test_helper"

class UserTest < ActiveSupport::TestCase
  # test "the truth" do
  #   assert true
  # end
end

================
File: test/test_helper.rb
================
ENV["RAILS_ENV"] ||= "test"
require_relative "../config/environment"
require "rails/test_help"

module ActiveSupport
  class TestCase
    # Run tests in parallel with specified workers
    parallelize(workers: :number_of_processors, with: :threads)

    # Setup all fixtures in test/fixtures/*.yml for all tests in alphabetical order.
    fixtures :all

    # Add more helper methods to be used by all tests here...
  end
end
